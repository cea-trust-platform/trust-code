%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Set of equations}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In function of your choice of problem type, you will have a different set of equations.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Incompressible problems}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\trust solves Navier-Stokes equations with/without the heat equation for an incompressible fluid:

$$
\left\{
\begin{array}{c}
\nabla \cdot \vec u =0 \\
\displaystyle{\frac{\partial \vec u }{\partial t} + \textcolor{red}{\nabla \cdot (\vec u \otimes \vec u)} = \textcolor{blue}{\nabla \cdot (\nu \nabla \vec u)} - \nabla P^* } \\
\displaystyle{\frac{\partial T}{\partial t} + \textcolor{red}{\vec u \nabla T} = \textcolor{blue}{\nabla \cdot (\alpha \nabla T)} + \frac{Q}{\rho C_p}}
\end{array}
\right.
$$

where: $\displaystyle{P^*=\frac{P}{\rho} + g z}$, $Q$ is the heat source term, and:

\begin{itemize}
\item $\rho$: density,
\item $\mu$: dynamic viscosity,
\item $\displaystyle{\nu=\frac{\mu}{\rho}}$: cinematic viscosity,
\item $\vec g=g z$: gravity vector in cartesian coordinates,
\item $\displaystyle{\alpha=\frac{\lambda}{\rho C_p}}$: thermal diffusivity.
\item $C_p$: specific heat capacity at constant pressure,
\item $\lambda$: thermal conductivity,
\end{itemize}

\Note that \textcolor{red}{red} terms are convective terms and \textcolor{blue}{blue} terms are diffusive terms.\\

\begin{center}
\fbox{ \begin{minipage}[c]{0.98\textwidth}
\begin{alltt}
{\bf{Pb\_\textcolor{magenta}{Thermo}hydraulique\textcolor{darkblue}{\_Concentration}\hspace{-0.15cm}\textcolor{Greeen}{\_Turbulent} } } \textit{my\_problem}

...

{\bf{Read}} \textit{my\_problem}

\{

\hspace{1cm}    \textcolor{blue}{\# Navier Stokes equations with/without turbulent model \#}

\hspace{1cm}    {\bf{Navier\_Stokes$\overbrace{\mbox{\_Standard}}^{\mbox{\textcolor{Greeen}{\_Turbulent}}}$} }

\hspace{1cm}    \{

\hspace{2cm}        {\bf{Solveur\_Pression}} \textit{my\_solver} \{ ... \}

\hspace{2cm}        {\bf{Diffusion}} \{ ... \}

\hspace{2cm}        {\bf{Convection}} \{ ... \}

\hspace{2cm}        {\bf{Initial\_conditions}} \{ ... \}

\hspace{2cm}        {\bf{Boundary\_conditions}} \{ ... \}

\hspace{2cm}        {\bf{\textcolor{Greeen}{Modele\_turbulence \textit{modele} \{ ... \} } }}

\hspace{2cm}        {\bf{Sources}} \{ ... \}

\hspace{2cm}       ...

\hspace{1cm}    \}

\hspace{1cm}    \textcolor{blue}{\# Energy equation with/without turbulent model \#}

\hspace{1cm}    {\bf{\textcolor{magenta}{Convection\_Diffusion\_Temperature}\textcolor{Greeen}{\_Turbulent}}}

\hspace{1cm}    \textcolor{magenta}{\{}

\hspace{2cm}        \textcolor{magenta}{{\bf{Diffusion}} \{ ... \}}

\hspace{2cm}        \textcolor{magenta}{{\bf{Convection}} \{ ... \}}

\hspace{2cm}        \textcolor{magenta}{{\bf{Initial\_conditions}} \{ ... \}}

\hspace{2cm}        \textcolor{magenta}{{\bf{Boundary\_conditions}} \{ ... \}}

\hspace{2cm}        \textcolor{magenta}{{\bf{\textcolor{Greeen}{Modele\_turbulence Prandtl \{ ... \} } }}}

\hspace{2cm}        \textcolor{magenta}{{\bf{Sources}} \{ ... \}}

\hspace{2cm}        \textcolor{magenta}{...}

\hspace{1cm}    \textcolor{magenta}{\}}

\hspace{1cm}    \textcolor{blue}{\# Constituent transportation equations with/without turbulent model \#}

\hspace{1cm}    {\bf{\textcolor{darkblue}{Convection\_Diffusion\_Concentration}\textcolor{Greeen}{\_Turbulent}}}

\hspace{1cm}    \textcolor{darkblue}{\{}

\hspace{2cm}        \textcolor{darkblue}{{\bf{Diffusion}} \{ ... \}}

\hspace{2cm}        \textcolor{darkblue}{{\bf{Convection}} \{ ... \}}

\hspace{2cm}        \textcolor{darkblue}{{\bf{Initial\_conditions}} \{ ... \}}

\hspace{2cm}        \textcolor{darkblue}{{\bf{Boundary\_conditions}} \{ ... \}}

\hspace{2cm}        \textcolor{darkblue}{{\bf{\textcolor{Greeen}{Modele\_turbulence Schmidt \{ ... \} } }}}

\hspace{2cm}        \textcolor{darkblue}{{\bf{Sources}} \{ ... \}}

\hspace{2cm}        \textcolor{darkblue}{...}

\hspace{1cm}    \textcolor{darkblue}{\}}

\}
\end{alltt}
\end{minipage}}
\end{center}

For documentation, see:\\

\begin{longtable}{|c|c|c|c|c|}
\hline
Thermo & hydraulique & Concentration & Turbulent & Reference Manual\tabularnewline
\hline 
\hline 
            & \textbf{Pb\_hydraulique}  &   
            &                           & \href{\REFERENCEMANUAL\#pbhydraulique}{doc} \tabularnewline 
\hline
            & \textbf{Pb\_hydraulique}  & \textbf{\textcolor{darkblue}{\_Concentration}}
            &                           & \href{\REFERENCEMANUAL\#pbhydrauliqueconcentration}{doc} \tabularnewline
\hline
            & \textbf{Pb\_hydraulique}  &   
            & \textbf{\textcolor{Greeen}{\_Turbulent}}      & \href{\REFERENCEMANUAL\#pbhydrauliqueturbulent}{doc} \tabularnewline
\hline
            & \textbf{Pb\_hydraulique}  & \textbf{\textcolor{darkblue}{\_Concentration}}
            & \textbf{\textcolor{Greeen}{\_Turbulent}}      & \href{\REFERENCEMANUAL\#pbhydrauliqueconcentrationturbulent}{doc} \tabularnewline
\hline
\textbf{Pb\_\textcolor{magenta}{Thermo}}     & \textbf{hydraulique}  &   
                        &                       & \href{\REFERENCEMANUAL\#pbthermohydraulique}{doc} \tabularnewline
\hline
\textbf{Pb\_\textcolor{magenta}{Thermo}}     & \textbf{hydraulique}  & \textbf{\textcolor{darkblue}{\_Concentration}}
                        &                       & \href{\REFERENCEMANUAL\#pbthermohydrauliqueconcentration}{doc} \tabularnewline
\hline
\textbf{Pb\_\textcolor{magenta}{Thermo}}     & \textbf{hydraulique}  &   
                        & \textbf{\textcolor{Greeen}{\_Turbulent}}  & \href{\REFERENCEMANUAL\#pbthermohydrauliqueturbulent}{doc} \tabularnewline
\hline
\textbf{Pb\_\textcolor{magenta}{Thermo}}     & \textbf{hydraulique}  & \textbf{\textcolor{darkblue}{\_Concentration}}
                        & \textbf{\textcolor{Greeen}{\_Turbulent}}  & \href{\REFERENCEMANUAL\#pbthermohydrauliqueconcentrationturbulent}{doc} \tabularnewline
\hline
\end{longtable}

\vspace{0.5cm}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Quasi-compressible problem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\trust solves Navier-Stokes equations with/without heat equation for quasi-compressible fluid:

$$
\left\{
\begin{array}{c}
\displaystyle{\frac{\partial \rho }{\partial t} + \nabla \cdot (\rho \vec u) =0 }\\
\displaystyle{ \frac{\partial \rho \vec u}{\partial t} + \textcolor{red}{\nabla \cdot (\rho \vec u \vec u)} =  \textcolor{blue}{\nabla \cdot \left(\mu \nabla \vec u \right)} - \nabla P -\rho \vec g }\\
\displaystyle{ \rho C_p \left( \frac{\partial T}{\partial t} + \textcolor{red}{\vec u \nabla T} \right) = \textcolor{blue}{\nabla \cdot \left(\lambda \nabla T\right)} + \frac{dP_0}{dt} + Q }
\end{array}
\right.
$$

where: $P_0=\rho R T$, $Q$ is a heat source term, and:

\begin{itemize}
\item $\rho$: density,
\item $\mu$: dynamic viscosity,
\item $\vec g=g z$: gravity vector in cartesian coordinates,
\item $C_p$: specific heat capacity at constant pressure,
\item $\lambda$: thermal conductivity.
\end{itemize}

\Note that \textcolor{red}{red} terms are convective terms and \textcolor{blue}{blue} terms are diffusive terms.\\


\begin{center}
\fbox{ \begin{minipage}[c]{0.95\textwidth}
\begin{alltt}
{\bf{Pb\_Thermohydraulique\textcolor{Greeen}{\_Turbulent}\_QC} } \textit{my\_problem}

...

{\bf{Read}} \textit{my\_problem}

\{

\hspace{1cm}    \textcolor{blue}{\# Navier Stokes equations for quasi-compressible fluid under \#}

\hspace{1cm}    \textcolor{blue}{\# low Mach numbers with/without turbulent model \#}

\hspace{1cm}    {\bf{Navier\_Stokes\textcolor{Greeen}{\_Turbulent}\_QC}}

\hspace{1cm}    \{

\hspace{2cm}        {\bf{Solveur\_Pression}} \textit{my\_solver} \{ ... \}

\hspace{2cm}        {\bf{Diffusion}} \{ ... \}

\hspace{2cm}        {\bf{Convection}} \{ ... \}

\hspace{2cm}        {\bf{Initial\_conditions}} \{ ... \}

\hspace{2cm}        {\bf{Boundary\_conditions}} \{ ... \}

\hspace{2cm}        {\bf{\textcolor{Greeen}{Modele\_turbulence \textit{modele} \{ ... \} } }}

\hspace{2cm}        {\bf{Sources}} \{ ... \}

\hspace{2cm}       ...

\hspace{1cm}    \}

\hspace{1cm}    \textcolor{blue}{\# Energy equation for quasi-compressible fluid under low Mach \#}

\hspace{1cm}    \textcolor{blue}{\# numbers with/without turbulent model \#}

\hspace{1cm}    {\bf{Convection\_Diffusion\_Chaleur}\textcolor{Greeen}{\_Turbulent}\_QC}

\hspace{1cm}    \{

\hspace{2cm}        {\bf{Diffusion}} \{ ... \}

\hspace{2cm}        {\bf{Convection}} \{ ... \}

\hspace{2cm}        {\bf{Initial\_conditions}} \{ ... \}

\hspace{2cm}        {\bf{Boundary\_conditions}} \{ ... \}

\hspace{2cm}        {\bf{\textcolor{Greeen}{Modele\_turbulence Prandtl \{ ... \} } }}

\hspace{2cm}        {\bf{Sources}} \{ ... \}

\hspace{2cm}        ...

\hspace{1cm}    \}

\}
\end{alltt}
\end{minipage}}
\end{center}

For more information on QC problem, go \href{\REFERENCEMANUAL\#pbthermohydrauliqueqc}{there} and for turbulent QC problem, go \href{\REFERENCEMANUAL\#pbthermohydrauliqueturbulentqc}{there}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Conduction problem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
For this kind of problem, \trust solves the heat equation:
$$
\rho C_p \frac{\partial T}{\partial t} = \textcolor{blue}{\nabla \cdot \left(\lambda \nabla T\right)} + Q
$$
where:
\begin{itemize}
\item $\rho$: density,
\item $C_p$: specific heat capacity at constant pressure,
\item $\lambda$: thermal conductivity,
\item $Q$ is a heat source term.
\end{itemize}

\Note that \textcolor{red}{red} terms are convective terms and \textcolor{blue}{blue} terms are diffusive terms.\\

In your data file, you will have:

\begin{center}
\fbox{ \begin{minipage}[c]{0.95\textwidth}
\begin{alltt}
{\bf{Pb\_Conduction} } \textit{my\_problem}

...

{\bf{Read}} \textit{my\_problem}

\{

\hspace{1cm}    \textcolor{blue}{\# Resolution of the heat equation \#}

\hspace{1cm}    {\bf{Conduction}}

\hspace{1cm}    \{

\hspace{2cm}        {\bf{Diffusion}} \{ ... \}

\hspace{2cm}        {\bf{Convection}} \{ ... \}

\hspace{2cm}        {\bf{Initial\_conditions}} \{ ... \}

\hspace{2cm}        {\bf{Boundary\_conditions}} \{ ... \}

\hspace{2cm}        {\bf{Sources}} \{ ... \}

\hspace{2cm}        ...

\hspace{1cm}    \}

\}
\end{alltt}
\end{minipage}}
\end{center}

For more information, see the \href{\REFERENCEMANUAL\#pbconduction}{\trustref Reference Manual}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Coupled problems}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
With \trust, we can couple problems. We will explain here the method for two problems
but you can couple as many problems as you want.\\

To couple two problems, we define two problems \textit{my\_problem\_1} and \textit{my\_problem\_2} each one associated to a separate domain \textit{my\_domain\_1} and \textit{my\_domain\_2}, and to a separate medium \textit{my\_medium\_1} and \textit{my\_medium\_2} (associated or not to the gravity).
\begin{center}
\fbox{ \begin{minipage}[c]{0.95\textwidth}
\begin{alltt}
{\bf{Dimension}} 2


{\bf{Pb_ThermoHydraulique_Turbulent}} \textit{my\_problem\_1}

{\bf{Pb_ThermoHydraulique_Turbulent}} \textit{my\_problem\_2}


{\bf{Domaine}} \textit{my\_domain\_1}

{\bf{Read\_file}} \textit{my\_mesh\_1.geo} ;


{\bf{Domaine}} \textit{my\_domain\_2}

{\bf{Read\_file}} \textit{my\_mesh\_2.geo} ;


{\bf{Fluide_Incompressible}} \textit{my\_medium\_1}

{\bf{Read}} \textit{my\_medium\_1} \{ ... \}


{\bf{Fluide_Incompressible}} \textit{my\_medium\_2}

{\bf{Read}} \textit{my\_medium\_2} \{ ... \}


{\bf{Associate}} \textit{my\_problem\_1} \textit{my\_domain\_1}

{\bf{Associate}} \textit{my\_problem\_1} \textit{my\_medium\_1}


{\bf{Associate}} \textit{my\_problem\_2} \textit{my\_domain\_2}

{\bf{Associate}} \textit{my\_problem\_2} \textit{my\_medium\_2}
\end{alltt}
\end{minipage}}
\end{center}


Then we define a coupled problem associated to a single time scheme like for example:
\begin{center}
\fbox{ \begin{minipage}[c]{0.95\textwidth}
\begin{alltt}
{\bf{Probleme\_Couple}} \textit{my\_coupled\_problem}


{\bf{VEFPreP1B}} \textit{my\_discretization}


{\bf{Scheme\_euler\_explicit}} \textit{my\_scheme}

{\bf{Read}} \textit{my\_scheme} \{ ... \}


{\bf{Associate}} \textit{my\_coupled\_problem} \textit{my\_problem\_1}

{\bf{Associate}} \textit{my\_coupled\_problem} \textit{my\_problem\_2}

{\bf{Associate}} \textit{my\_coupled\_problem} \textit{my\_scheme}
\end{alltt}
\end{minipage}}
\end{center}

Then we discretize and solve everything:
\begin{center}
\fbox{ \begin{minipage}[c]{0.95\textwidth}
\begin{alltt}
{\bf{Discretize}} \textit{my\_coupled\_problem} \textit{my\_discretization}

{\bf{Read}} \textit{my\_problem\_1} \{ ... \}

{\bf{Read}} \textit{my\_problem\_2} \{ ... \}

{\bf{Solve}} \textit{my\_coupled\_problem}

{\bf{End}}
\end{alltt}
\end{minipage}}
\end{center}

You can see the documentation of this kind of problem in the \href{\REFERENCEMANUAL\#coupledproblem}{\trustref Reference Manual}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Other problems}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\trust can also solve the following types of problems:
\begin{itemize}
%\item \href{\REFERENCEMANUAL\#problemeftdiscgen}{Front-Tracking problems},
%\item \href{\REFERENCEMANUAL\#pbphasefield}{Problems to solve local instantaneous incompressible-two-phase-flows},
\item \href{\REFERENCEMANUAL\#pbthermohydrauliqueconcentrationscalairespassifs}{Resolution of NAVIER STOKES/energy/multiple constituent transportation equations, with the additional passive scalar equations}, and
\item \href{\REFERENCEMANUAL\#chimie}{describe the chemical reactions}.
\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Pressure solvers}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Then you may indicate the choice of pressure solver (cf \href{\REFERENCEMANUAL\#solveursysbase}{\trustref Reference Manual}) using the following syntax:
    \begin{center}
    \fbox{ \begin{minipage}[c]{0.7\textwidth}
    \begin{alltt}
    {\bf{Solveur\_pression}}  \textit{my\_solver } \{ ... \}
    \end{alltt}
    \end{minipage}}
    \end{center}

The \textit{my\_solver} may be:

\begin{itemize}
\item \href{\REFERENCEMANUAL\#solvgcp}{\textbf{GCP}},
\item \href{\REFERENCEMANUAL\#petsc}{\textbf{Petsc} \textit{Petsc\_solver\_name}},
\item \href{\REFERENCEMANUAL\#cholesky}{\textbf{Cholesky}},
\item \href{\REFERENCEMANUAL\#gmres}{\textbf{Gmres}},
\item \href{\REFERENCEMANUAL\#gen}{\textbf{Gen}},
\item \href{\REFERENCEMANUAL\#optimal}{\textbf{Optimal}}.
%\item \textbf{Gmres} or \textbf{Gen} or \textbf{Optimal} (cf to the \href[page=DOCLINK_OTHER SOLVERS]{\REFERENCEMANUAL}{\trustref Reference Manual}).
\end{itemize}

Reminder: in CFD, a separate solver is used to solve the pressure. For more details, you can have a look at the section "Time and space schemes" of the \href{TRUST_and_TrioCFD_presentation.pdf}{the \trust \& \textbf{TrioCFD} user slides}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Convection}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
There is no default convective scheme so you must choose one \href{\REFERENCEMANUAL\#blocconvection}{convection scheme}:
    \begin{center}
    \fbox{ \begin{minipage}[c]{0.5\textwidth}
    \begin{alltt}
    {\bf{convection}} \{ \textit{convective\_scheme} \}
    \end{alltt}
    \end{minipage}}
    \end{center}

You can use the following convective scheme, following the recommendations of the user training session (cf section "Time and space schemes" of the \href{TRUST_and_TrioCFD_presentation.pdf}{the \trust \& \textbf{TrioCFD} user slides} and the section "Recommendations for schemes") following your discretization type:
\begin{itemize}
\item \href{\REFERENCEMANUAL\#convectionamont}{\textbf{Amont}}
\item \href{\REFERENCEMANUAL\#convectionmuscl}{\textbf{Muscl}}
\item \href{\REFERENCEMANUAL\#convectionefstab}{\textbf{EF\_stab}}
\item for more, see the \href{\REFERENCEMANUAL\#blocconvection}{\trustref Reference Manual}.
\end{itemize}

\Note that there is no default convective scheme and if you don't want convection in your problem, you may use:

    \begin{center}
    \fbox{ \begin{minipage}[c]{0.5\textwidth}
    \begin{alltt}
    {\bf{convection \{ negligeable \} }}
    \end{alltt}
    \end{minipage}}
    \end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Diffusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
For the diffusive scheme, it is the same syntax:

    \begin{center}
    \fbox{ \begin{minipage}[c]{0.5\textwidth}
    \begin{alltt}
    {\bf{diffusion}} \{ [\textit{diffusive\_scheme}] \}
    \end{alltt}
    \end{minipage}}
    \end{center}

You can choose your scheme with the help of the \href{\REFERENCEMANUAL\#blocdiffusion}{\trustref Reference Manual}.\\

\Note that if you don't specify any diffusive scheme, the code automatically uses the standard diffusive scheme of order 2.
If you don't want diffusion in your problem, you may use:

    \begin{center}
    \fbox{ \begin{minipage}[c]{0.5\textwidth}
    \begin{alltt}
    {\bf{diffusion \{ negligeable \} }}
    \end{alltt}
    \end{minipage}}
    \end{center}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Initial conditions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
For each equation, you \textbf{must} set initial conditions:
\begin{center}
\fbox{ \begin{minipage}[c]{0.5\textwidth}
\begin{alltt}
{\bf{initial\_conditions}} \{ ... \}
\end{alltt}
\end{minipage}}
\end{center}

To see the syntax of each available initial condition: cf \href{\REFERENCEMANUAL\#condinits}{\trustref Reference Manual}.
Here are the most used initial conditions:
\begin{itemize}
\item \textbf{Velocity}     field\_type   \textit{bloc\_lecture\_champ}
\item \textbf{Temperature}  field\_type   \textit{bloc\_lecture\_champ}
\item \textbf{K\_eps}       field\_type   \textit{bloc\_lecture\_champ}
%\item \textbf{Flux\_Chaleur\_Turbulente}    field\_type   \textit{bloc\_lecture\_champ}
%\item \textbf{Fluctu\_Temperature}          field\_type   \textit{bloc\_lecture\_champ}
%\item for more, see the \href{\REFERENCEMANUAL\#condinits}{\trustref Reference Manual}.
\end{itemize}

We list here some "field\_type":
\begin{itemize}
\item \href{\REFERENCEMANUAL\#uniformfield}{\textbf{Uniform\_Field}}: for a uniform field,
\item \href{\REFERENCEMANUAL\#champfoncmed}{\textbf{Champ\_Fonc\_Med}}: to read a data field in a MED-format file .med at a specified time,
\item \href{\REFERENCEMANUAL\#fieldfunctxyz}{\textbf{Champ\_Fonc\_txyz}}: for a field which depends on time and space,
\item \href{\REFERENCEMANUAL\#champfoncfonctiontxyz}{\textbf{Champ\_Fonc\_Fonction\_txyz}}: for a field which is a function of another field and time and/or space coordinates,
\item \href{\REFERENCEMANUAL\#champfoncreprise}{\textbf{Champ\_Fonc\_Reprise}}: to read a data field in a saved file (.xyz or .sauv) at a specified time.
\item refer to the \href{\REFERENCEMANUAL\#fieldbase}{\trustref Reference Manual}.
\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Boundary conditions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Then you may specify your boundary conditions like:

    \begin{center}
    \fbox{ \begin{minipage}[c]{0.5\textwidth}
    \begin{alltt}
    {\bf{boundary\_conditions}} \{ ... \}
    \end{alltt}
    \end{minipage}}
    \end{center}

It is important to specify here that \textbf{TRUST will not accept any boundary conditions by default.}\\

You can find help for boundary conditions in the \href{\REFERENCEMANUAL\#condlimbase}{\trustref Reference Manual}.
Here is a list of the most used boundary conditions:
{\small{
\begin{itemize}
\item \href{\REFERENCEMANUAL\#frontiereouvertevitesseimposee}{\textbf{Bord Frontiere\_ouverte\_vitesse\_imposee}}    boundary\_field\_type \textit{bloc\_lecture\_champ}
%\item \textbf{Bord Frontiere\_ouverte\_rho\_u\_impose}      boundary\_field\_type \textit{bloc\_lecture\_champ}
\item \href{\REFERENCEMANUAL\#frontiereouvertepressionimposee}{\textbf{Bord Frontiere\_ouverte\_pression\_imposee}}   boundary\_field\_type \textit{bloc\_lecture\_champ}
%\item \textbf{Bord Frontiere\_ouverte\_gradient\_pression\_impose} boundary\_field\_type \textit{bloc\_lecture\_champ}
%\item \textbf{Bord Frontiere\_ouverte\_pression\_imposee\_Orlansky }
\item \href{\REFERENCEMANUAL\#paroifixe}{\textbf{Bord Paroi\_fixe}}
%\item \textbf{Bord Paroi\_decalee\_Robin \{ delta value \} }
\item \href{\REFERENCEMANUAL\#symetrie}{\textbf{Bord Symetrie}}
\item \href{\REFERENCEMANUAL\#periodic}{\textbf{Bord Periodique}}
%\item \textbf{Bord Paroi\_rugueuse} \{ \textbf{erugu} value \}
\item \href{\REFERENCEMANUAL\#frontiereouvertetemperatureimposee}{\textbf{Bord Frontiere\_ouverte\_temperature\_imposee}}                        boundary\_field\_type \textit{bloc\_lecture\_champ}
%\item \textbf{Bord Frontiere\_ouverte\_temperature\_imposee\_rayo\_semi\_transp}    boundary\_field\_type \textit{bloc\_lecture\_champ}
\item \href{\REFERENCEMANUAL\#frontiereouverte}{\textbf{Bord Frontiere\_ouverte T\_ext}}                       boundary\_field\_type \textit{bloc\_lecture\_champ}
%\item \textbf{Bord Frontiere\_ouverte\_rayo\_semi\_transp T\_Ext}   boundary\_field\_type \textit{bloc\_lecture\_champ}
%\item \textbf{Bord Frontiere\_ouverte\_rayo\_transp T\_Ext}         boundary\_field\_type \textit{bloc\_lecture\_champ}
\item \href{\REFERENCEMANUAL\#paroiadiabatique}{\textbf{Bord Paroi\_adiabatique}}
\item \href{\REFERENCEMANUAL\#paroifluximpose}{\textbf{Bord Paroi\_flux\_impose}}                             boundary\_field\_type \textit{bloc\_lecture\_champ}
%\item \textbf{Bord Paroi\_temperature\_imposee}                     boundary\_field\_type \textit{bloc\_lecture\_champ}
%\item \textbf{Bord Paroi\_echange\_externe\_impose H\_imp}          boundary\_field\_type \textit{bloc\_lecture\_champ}  \textbf{T\_ext}   boundary\_field\_type \textit{bloc\_lecture\_champ}
%\item \textbf{Bord Frontiere\_ouverte\_concentration\_imposee}      boundary\_field\_type \textit{bloc\_lecture\_champ\_front}
%\item \textbf{Bord Frontiere\_ouverte C\_ext}                       boundary\_field\_type \textit{bloc\_lecture\_champ\_front}
%\item \textbf{Bord Frontiere\_ouverte\_K\_Eps\_impose}              boundary\_field\_type \textit{bloc\_lecture\_champ\_front}
%\item \textbf{Bord Frontiere\_ouverte K\_Eps\_ext}                  boundary\_field\_type \textit{bloc\_lecture\_champ\_front}
%\item \textbf{Bord Paroi}
\item for more, see the \href{\REFERENCEMANUAL\#condlimbase}{\trustref Reference Manual}.
\end{itemize}
}}

To choose your "boundary\_field\_type" parameters, refer to the \href{\REFERENCEMANUAL\#frontfieldbase}{\trustref Reference Manual}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Turbulent model}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
User can add a turbulent model to his simulation using the keyword:
\begin{center}
\fbox{ \begin{minipage}[c]{0.7\textwidth}
\begin{alltt}
{\bf{Modele\_turbulence}} \textit{my\_model} \{ ... \}
\end{alltt}
\end{minipage}}
\end{center}

where \textit{my\_model} can be:
\begin{itemize}
\item \href{\REFERENCEMANUAL\#longueurmelange}{\textbf{Longueur\_Melange}}: RANS model based on mixing length modelling,
\item \href{\REFERENCEMANUAL\#sousmaille}{\textbf{Sous\_maille}}: LES model which uses a structure sub-grid function model,
%\item \textbf{Sous\_maille\_Smago}
%\item \textbf{Sous\_maille\_wale}
\item \href{\REFERENCEMANUAL\#kepsilon}{\textbf{K\_epsilon}}: for RANS turbulence model (k-$\varepsilon$),
%\item \textbf{K\_epsilon\_2\_Couches}
\item for more, see the \href{\REFERENCEMANUAL\#modeleturbulencehydderiv}{\trustref Reference Manual}.
\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Source terms}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
To introduce a source term into an equation, add the following line into the block defining the equation. The list of source keyword is described below.
\begin{center}
\fbox{ \begin{minipage}[c]{0.5\textwidth}
\begin{alltt}
{\bf{Sources}}  \textit{ \{ source\_keyword \}}
\end{alltt}
\end{minipage}}
\end{center}

To introduce several source terms into the same equation, the blocks corresponding to the various terms need to be separated by a comma:
\begin{center}
\fbox{ \begin{minipage}[c]{0.7\textwidth}
\begin{alltt}
{\bf{Sources}}  \textit{ \{ source\_keyword1 , source\_keyword2 , ...\}}
\end{alltt}
\end{minipage}}
\end{center}

\begin{itemize}
\item \href{\REFERENCEMANUAL\#pertechargereguliere}{\textbf{Perte\_Charge\_Reguliere}} type\_perte\_charge bloc\_definition\_pertes\_charges
%\item \textbf{Perte\_Charge\_Isotrope} \{ ... \} 
\item \href{\REFERENCEMANUAL\#pertechargesinguliere}{\textbf{Perte\_Charge\_Singuliere}} \textbf{KX | KY | KZ} coefficient\_value \{ ... \} 
%\item \textbf{Source\_Qdm}   field\_type   field\_description
\item \href{\REFERENCEMANUAL\#canalperio}{\textbf{Canal\_perio}} \{ ... \} 
%\item \textbf{Source\_Robin} N boundary\_name\_1  ... boundary\_name\_N 
\item \href{\REFERENCEMANUAL\#boussinesqtemperature}{\textbf{Boussinesq\_temperature}} \{ ... \}: $\rho(T)=\rho(T_0)(1-\beta_{th}(T-T_0))$
\item \href{\REFERENCEMANUAL\#boussinesqconcentration}{\textbf{Boussinesq\_concentration}} \{ ... \}
%\item \textbf{Source\_Th\_TdivU }
\item \href{\REFERENCEMANUAL\#puissancethermique}{\textbf{Puissance\_thermique}} field\_type   bloc\_lecture\_champ 
%\item \textbf{Source\_Robin\_Scalaire  ...}
%\item \textbf{Source\_Generique} field\_type   bloc\_lecture\_champ
\item \href{\REFERENCEMANUAL\#sourcebase}{documentation for hydraulic source terms and for scalar source terms}.
\end{itemize}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Post-process}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Before post-processing fields, during a run, \trust creates several files which contain informations about the calculation, the convergence, flux, balances... (see part \ref{post} for more informations).\\

Several keywords can be used to create a postprocessing block, into a problem. First, you can create a single postprocessing task (\href{\REFERENCEMANUAL\#postraitement}{\textbf{Post\_processing}} keyword). Generally, in this block, results will be printed with a specified format at a specified time period.
\begin{center}
\fbox{ \begin{minipage}[c]{0.5\textwidth}
\begin{alltt}
{\bf{Post\_processing }}

\{

\hspace{1cm}    \textit{Postraitement\_definition}

\}
\end{alltt}
\end{minipage}}
\end{center}

But you can also create a list of postprocessings with \href{\REFERENCEMANUAL\#postraitements}{\textbf{Post\_processings}} keyword (named with Post\_name1, Post\_name2, etc...), in order to print results into several formats or with different time periods, or into different results files:
\begin{center}
\fbox{ \begin{minipage}[c]{0.6\textwidth}
\begin{alltt}
{\bf{Post\_processings }}

\{

\hspace{1cm}  \textit{Post\_name1  \{ Postraitement\_definition \} }

\hspace{1cm}  \textit{Post\_name2  \{ Postraitement\_definition \} }

\hspace{1cm} ...

\}
\end{alltt}
\end{minipage}}
\end{center}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Field names}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{itemize}
\item \textcolor{darkblue}{\textbf{Existing \& predefined fields}}

You can post-process predefined fields and already existing fields.
Here is a list of post-processable fields, but it is not the only ones.

\small
\input{fieldnames.tex}
\normalsize

\begin{remark}
Physical properties (conductivity, diffusivity,...) can also be interrogated.
\end{remark}


\textbf{The name of the fields and components available for post-processing is displayed in the error file after the following message: "Reading of fields to be postprocessed". Of course, this list depends of the problem being solved.}

For more informations, you can see the \href{\REFERENCEMANUAL\#champsapost}{\trustref Reference Manual}.
%\vspace{1cm}

\item \textcolor{darkblue}{\textbf{Creating new fields}}

The \href{\REFERENCEMANUAL\#definitionchamps}{\textbf{Definition\_champs}} keyword is used to create new or more complex fields for advanced postprocessing.

\begin{center}
\fbox{ \begin{minipage}[c]{0.8\textwidth}
\begin{alltt}
{\bf{Definition\_champs}} \{ \textit{field\_name\_post} {\bf{\textit{field\_type}}} \{ ... \} \}
\end{alltt}
\end{minipage}}
\end{center}


%%%    \begin{center}
%%%    \fbox{ \begin{minipage}[c]{0.7\textwidth}
%%%    \begin{alltt}
%%%    {\bf{Definition\_champs}} \{ 

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{refChamp}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Interpolation}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Gradient}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Divergence}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Moyenne}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Ecart\_Type}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Correlation}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Transformation}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Extraction}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Reduction\_0D}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Morceau\_Equation}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Predefini}} \{ ... \}]

%%%    \hspace{1cm}    [{\textit{field\_name\_post}} {\bf{Tparoi\_VEF}} \{ ... \}]

%%%    \}

%%%    \end{alltt}
%%%    \end{minipage}}
%%%    \end{center}

\textit{field\_name\_post} is the name of the new created field and \textbf{\textit{field\_type}} is one of the following possible type:
\begin{itemize}
\item \href{\REFERENCEMANUAL\#refchamp}{\textbf{refChamp}}
\item \href{\REFERENCEMANUAL\#reduction0d}{\textbf{Reduction\_0D}} using for example the \textbf{min}, \textbf{max} or \textbf{somme} methods.
\item \href{\REFERENCEMANUAL\#transformation}{\textbf{Transformation}}
%\item Interpolation
%\item \textbf{Gradient}
%\item Divergence
%\item Moyenne
%\item Ecart\_Type
%\item Correlation
%\item Extraction
%\item Morceau\_Equation
%\item Predefini
%\item Tparoi\_VEF
\item for details and other keywords, see the \href{\REFERENCEMANUAL\#definitionchamps}{\trustref Reference Manual}.
\end{itemize}

\Note that you can combine several \textbf{\textit{field\_type}} keywords to create your field and then use your new fields to create other ones.\\

Here is an example of new field named \textit{max\_temperature}:

\begin{center}
\fbox{ \begin{minipage}[c]{0.9\textwidth}
\begin{alltt}
{\bf{Read}} \textit{my\_problem} \{

\hspace{0.5cm}    ...

\hspace{0.5cm}    {\bf{Postraitement}} \{

\hspace{1cm}        {\bf{Definition\_champs}} \{

\hspace{1.5cm}            \textcolor{blue}{\# Creation of a 0D field: maximal temperature of the domain \#}

\hspace{1.5cm}            \textit{max\_temperature} {\bf{Reduction\_0D}} \{

\hspace{2cm}            {\bf{methode max}}

\hspace{2cm}            {\bf{source refChamp}} \{ {\bf{Pb\_champ}} \textit{my\_problem} {\bf{temperature}} \}

\hspace{1.5cm}            \}

\hspace{1cm}        \}

\hspace{1cm}        {\bf{Probes}} \{

\hspace{1.5cm}            \textcolor{blue}{\# Print max(temperature) into the datafile\_TMAX.son file \#}

\hspace{1.5cm}            \textit{tmax} \textit{max\_temperature} {\bf{periode}} 0.01 {\bf{point}} 1 0. 0.

\hspace{1cm}        \}

\hspace{1cm}        {\bf{Champs dt\_post}} 1.0 \{ ... \}

\hspace{0.5cm}        \}

\}
\end{alltt}
\end{minipage}}
\end{center}

You can find other examples in the \href{TRUST_and_TrioCFD_presentation.pdf}{the \trust \& \textbf{TrioCFD} user slides} in the section "Post processing description".
\end{itemize}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Post-processing blocks}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
There are three method to post-process in \trust: using probes, fields or making statistics.


\begin{itemize}
\item \textcolor{darkblue}{\textbf{Probes}}\\
Probes refer to sensors that allow a value or several points of the domain to be monitored over time.
The probes are a set of points defined:
\begin{itemize}
\item one by one: \href{\REFERENCEMANUAL\#points}{\textbf{Points}} keyword or 
\item by a set of points evenly distributed over a straight segment: \href{\REFERENCEMANUAL\#segment}{\textbf{Segment}} keyword or
\item arranged according to a layout: \href{\REFERENCEMANUAL\#plan}{\textbf{Plan}} keyword or
\item arranged according to a parallelepiped: \href{\REFERENCEMANUAL\#volume}{\textbf{Volume}} keyword.
\end{itemize}

Here is an example of 2D \textbf{Probes} block:
    \begin{center}
    \fbox{ \begin{minipage}[c]{0.92\textwidth}
    \begin{alltt}
    {\bf{Probes}} \{

        \hspace{0.2cm}     \textit{pressure\_probe} \textit{[loc]} {\bf{pressure Periode}} 0.5 {\bf{Points}}      3  1.  0.   1.   1.   1.   2.

        \hspace{0.2cm}     \textit{velocity\_probe} \textit{[loc]} {\bf{velocity Periode}} 0.5 {\bf{Segment}}     10  1.  0.      1.   4.

    \}
    \end{alltt}
    \end{minipage}}
    \end{center}
where the use of \textit{"loc"} option allow to specify the wanted localisation of the probes. The available values are \textbf{"grav"} for gravity center of the element, \textbf{"nodes"} for faces and \textbf{"som"} for vertices. There is not default location. If the point does not coincide with a calculation node, the value is extrapolated linearly according to neighbouring node values.

For complete syntax, see the \href{\REFERENCEMANUAL\#corpspostraitement}{\trustref Reference Manual}, also for \href{\REFERENCEMANUAL\#sondes}{all options}.

%%    \begin{center}
%%    \fbox{ \begin{minipage}[c]{1\textwidth}
%%    \begin{alltt}
%%    {\bf{Probes}} \{

%%    \hspace{1cm}    [nom\_sonde [type] field\_name {\bf{Periode}} dts

%%        \hspace{1.5cm} | {\bf{Points}}      {\bf{position\_like}} nom\_sonde

%%        \hspace{1.5cm} | {\bf{Points}}      n x1 y1 [z1] x2 y2 [z2] .... xn yn [zn]]

%%    \hspace{1cm}    [nom\_sonde [type] field\_name {\bf{Periode}} dts

%%        \hspace{1.5cm} | {\bf{Segment}}     {\bf{position\_like}} nom\_sonde

%%        \hspace{1.5cm} | {\bf{Segment}}     ns x1 y1 [z1] x2 y2 [z2]]

%%    \hspace{1cm}    [nom\_sonde [type] field\_name {\bf{Periode}} dts 

%%        \hspace{1.5cm} | {\bf{Segmentpoints}}       {\bf{position\_like}} nom\_sonde

%%        \hspace{1.5cm} | {\bf{Segmentpoints}}       ns x1 y1 [z1] x2 y2 [z2] .... xn yn [zn]]

%%    \hspace{1cm}    [nom\_sonde [type] field\_name {\bf{Periode}} dts

%%        \hspace{1.5cm} | {\bf{Plan}}    {\bf{position\_like}} nom\_sonde

%%        \hspace{1.5cm} | {\bf{Plan}}    ns1 ns2  x1 y1 [z1] x2 y2 [z2] x3 y3 [z3]]

%%    \hspace{1cm}    [nom\_sonde [type] field\_name {\bf{Periode}} dts

%%        \hspace{1.5cm} | {\bf{Volume}}      {\bf{position\_like}} nom\_sonde

%%        \hspace{1.5cm} | {\bf{Volume}}      ns1 ns2 ns3  x1 y1 z1 x2 y2 z2 x3 y3 z3 x4 y4 z4]

%%    \hspace{1cm}    [nom\_sonde [type] field\_name {\bf{Periode}} dts

%%        \hspace{1.5cm} | {\bf{Circle}}      {\bf{position\_like}} nom\_sonde

%%        \hspace{1.5cm} | {\bf{Circle}}      n x0 y0 [z0 dir] r teta1 teta2]

%%    \hspace{1cm}    [nom\_sonde [type] field\_name {\bf{Periode}} dts {\bf{Numero\_elem\_sur\_maitre}} integer

%%    \}
%%    \end{alltt}
%%    \end{minipage}}
%%    \end{center}



\item \textcolor{darkblue}{\textbf{Fields}}\\
This keyword allows to post-process fields on the whole domain, specifying the name of the backup file, its format, the post-process time step and the name (and localisation) of the post-processed fields.

Here is an example of \href{\REFERENCEMANUAL\#champsposts}{\textbf{Fields}} block:
    \begin{center}
    \fbox{ \begin{minipage}[c]{0.5\textwidth}
    \begin{alltt}
    {\bf{Fichier}} \textit{results}

    {\bf{Format lata}}

    {\bf{Fields}} {\bf{dt\_post}} 1.  \{

        \hspace{1cm}     {\bf{velocity   [faces] [som] [elem]}}

        \hspace{1cm}    {\bf{pressure   [elem] [som]}}

        \hspace{1cm}    {\bf{temperature [elem] [som] }}

    \}
    \end{alltt}
    \end{minipage}}
    \end{center}

where \textbf{"faces"} , \textbf{"elem"} and \textbf{"som"} are keywords allowed to specify the localisation of the field.\\

\Note that \underline{when you don't specify the localisation of the field}, the default value is \textbf{"som"} for values at the vertices. So fields are post-processed at the vertices of the mesh.\\

To visualize your post-processed fields, you can use open source softwares like: \href{https://wci.llnl.gov/simulation/computer-codes/visit}{VisIt} (included in \trust package) for lata files, or for med files: \href{http://www.salome-platform.org}{Salom\'e} or \href{http://www.paraview.org}{Paraview}.\\

You can see the \href{\REFERENCEMANUAL\#corpspostraitement}{complete syntax} and \href{\REFERENCEMANUAL\#champsposts}{all options} in the \trustref Reference Manual.



\item \textcolor{darkblue}{\textbf{Statistics}}\\
Using this keyword, you will compute statistics on your unknows. You must specify the begining and ending time for the statistics, the post-process time step, the statistic method, the name (and localisation) of your post-processed field.

Here is an example of \href{\REFERENCEMANUAL\#statsposts}{\textbf{Statistiques}} block:
    \begin{center}
    \fbox{ \begin{minipage}[c]{0.7\textwidth}
    \begin{alltt}
    {\bf{Statistiques dt\_post}} 0.1 \{

        \hspace{1cm}  {\bf{t\_deb}} 1. {\bf{t\_fin}} 5.

        \hspace{1cm}  {\bf{moyenne  velocity [faces] [elem] [som]}}

        \hspace{1cm}  {\bf{ecart\_type pressure [elem] [som]}}

        \hspace{1cm}  {\bf{correlation pressure velocity [elem] [som] }}

    \}
    \end{alltt}
    \end{minipage}}
    \end{center}

%%    {\bf{Statistiques\_en\_serie Dt\_integr}} dtst \{
%%        \hspace{1cm}  {\bf{t\_deb}} value {\bf{t\_fin}} value 
%%        \hspace{1cm}  [{\textit{stat}}  field\_name] [localisation]
%%        \hspace{1cm}  ...
%%    \}

This block will write at every \textbf{dt\_post} the average of the velocity $\overline{V(t)}$:
\[
\overline{V(t)}=\left\{ \begin{array}{ll}
0 & ,\mbox{ for }t\leq t\mbox{\_}deb\\
\frac{1}{t-t\mbox{\_}deb}{\displaystyle \int_{t\mbox{\_}deb}^{t}V(t)dt} & ,\mbox{ for }t\mbox{\_}deb<t\leq t\mbox{\_}fin\\
\frac{1}{t\mbox{\_}fin-t\mbox{\_}deb}{\displaystyle \int_{t\mbox{\_}deb}^{t\mbox{\_}fin}V(t)dt} & ,\mbox{ for }t>t\mbox{\_}fin
\end{array}\right.
\]

the standard deviation of the pressure $\left\langle P(t)\right\rangle$:
\[
\left\langle P(t)\right\rangle=\left\{ \begin{array}{ll}
0 & ,\mbox{ for }t\leq t\mbox{\_}deb\\
\frac{1}{t-t\mbox{\_}deb}{\displaystyle \sqrt{\int_{t\mbox{\_}deb}^{t}\left[P(t)-\overline{P(t)}\right]^{2}dt}} & ,\mbox{ for }t\mbox{\_}deb<t\leq t\mbox{\_}fin\\
\frac{1}{t\mbox{\_}fin-t\mbox{\_}deb}{\displaystyle \sqrt{\int_{t\mbox{\_}deb}^{t\mbox{\_}fin}\left[P(t)-\overline{P(t)}\right]^{2}dt}} & ,\mbox{ for }t>t\mbox{\_}fin
\end{array}\right.
\]

and correlation between the pressure and the velocity $\left\langle P(t).V(t)\right\rangle$ like:
\[
\left\langle P(t).V(t)\right\rangle=\left\{ \begin{array}{ll}
0 & ,\mbox{ for }t\leq t\mbox{\_}deb\\
\frac{1}{t-t\mbox{\_}deb}{\displaystyle \int_{t\mbox{\_}deb}^{t}\left[P(t)-\overline{P(t)}\right]\cdot\left[V(t)-\overline{V(t)}\right]dt} & ,\mbox{ for }t\mbox{\_}deb<t\leq t\mbox{\_}fin\\
\frac{1}{t\mbox{\_}fin-t\mbox{\_}deb}{\displaystyle \int_{t\mbox{\_}deb}^{t\mbox{\_}fin}\left[P(t)-\overline{P(t)}\right]\cdot\left[V(t)-\overline{V(t)}\right]dt} & ,\mbox{ for }t>t\mbox{\_}fin
\end{array}\right.
\]


\begin{remark}
Statistical fields can be plotted with probes with the keyword "operator\_field\_name" like for example: Moyenne\_Vitesse or Ecart\_Type\_Pression or Correlation\_Vitesse\_Vitesse. For that, it is mandatory to have the statistical calculation of this fields defined with the keyword \textbf{Statistiques}.\\
\end{remark}

For the complete syntax, see the \trustref Reference Manual \href{\REFERENCEMANUAL\#corpspostraitement}{here}, and for all options see the \href{\REFERENCEMANUAL\#statsposts}{\trust Reference Manual}.
\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Post-process localisation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
You can use localisation keywords to specify where you want to post-process your fields in order to avoid interpolations on your post-processed fields.\\

%For example, in VDF, pressure field is computed at the vertices so if we put \textbf{"elem"} keyword, the post-processed field will be taken at the center of the element so it won't be interpolated. If we use \textbf{"faces"} keyword for VDF pressure, we will get interpolated field.

For the \textbf{VDF} discretization, you can see the Figure \ref{fig_VDF} and here is a table with a reminder of the computation location of the fields in the \textbf{VDF} discretization:

%\begin{longtable}[h!]{|c|c|c|c|c|}
%\hline 
%\textbf{Names}              & \textbf{Keyword}                  & \textbf{Localisation}     & \textbf{Probes}   & \textbf{Fields}   \\ \hline
%\hline
%Pressure                    & \textbf{pressure}                 & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%Velocity                    & \textbf{velocity}                 & faces center              & \textbf{nodes}    & \textbf{faces}    \\ \hline
%Temperature                 & \textbf{temperature}              & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%\hline
%Density $\rho$              & \textbf{masse\_volumique}         & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%Cinematic viscosity $\nu$   & \textbf{viscosite\_cinematique}   & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%Dynamic viscosity $\mu$     & \textbf{viscosite\_dynamique}     & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%\hline
%K                           & \textbf{k}                        & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%eps                         & \textbf{eps}                      & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%$y^+$                       & \textbf{y\_plus}                  & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%$u^*$                       & \textbf{u\_star}                  & faces center              & \textbf{nodes}    & \textbf{faces}    \\ \hline
%Turbulent viscosity         & \textbf{viscosite\_turbulente}    & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%\end{longtable}

\begin{longtable}[h!]{|c|c|c|c|c|}
\hline 
\textbf{Names}              & \textbf{Keyword}                  & \textbf{Localisation}     \\ \hline
\hline
Pressure                    & \textbf{pressure}                 & element gravity center    \\ \hline
Velocity                    & \textbf{velocity}                 & faces center              \\ \hline
Temperature                 & \textbf{temperature}              & element gravity center    \\ \hline
\hline
Density $\rho$              & \textbf{masse\_volumique}         & element gravity center    \\ \hline
Cinematic viscosity $\nu$   & \textbf{viscosite\_cinematique}   & element gravity center    \\ \hline
Dynamic viscosity $\mu$     & \textbf{viscosite\_dynamique}     & element gravity center    \\ \hline
\hline
K                           & \textbf{k}                        & element gravity center    \\ \hline
eps                         & \textbf{eps}                      & element gravity center    \\ \hline
$y^+$                       & \textbf{y\_plus}                  & element gravity center    \\ \hline
$u^*$                       & \textbf{u\_star}                  & faces center              \\ \hline
Turbulent viscosity         & \textbf{viscosite\_turbulente}    & element gravity center    \\ \hline
\end{longtable}


For the \textbf{VEFPreP1B} discretization, you can see the Figure \ref{fig_VEF} and \ref{fig_VEF_pressure_loc}. Here is a table with a reminder of the computation location of the fields in \textbf{VEFPreP1B} discretization:

\begin{longtable}[h!]{|c|c|c|c|c|}
\hline 
\textbf{Names}              & \textbf{Keyword}                  & \textbf{Localisation}     \\ \hline
\hline
                            &                                   & element gravity center    \\
Pressure                    & \textbf{pressure}                 & vertices                  \\ \hline
%                            &                                   & faces center (for 3D)     \\ \hline
Velocity                    & \textbf{velocity}                 & faces center              \\ \hline
Temperature                 & \textbf{temperature}              & faces center              \\ \hline
\hline
Density $\rho$              & \textbf{masse\_volumique}         & element gravity center    \\ \hline
Cinematic viscosity $\nu$   & \textbf{viscosite\_cinematique}   & element gravity center    \\ \hline
Dynamic viscosity $\mu$     & \textbf{viscosite\_dynamique}     & element gravity center    \\ \hline
\hline
K                           & \textbf{k}                        & faces center              \\ \hline
eps                         & \textbf{eps}                      & faces center              \\ \hline
$y^+$                       & \textbf{y\_plus}                  & element gravity center    \\ \hline
$u^*$                       & \textbf{u\_star}                  & faces center              \\ \hline
Turbulent viscosity         & \textbf{viscosite\_turbulente}    & element gravity center    \\ \hline
\end{longtable}


%\begin{longtable}[h!]{|c|c|c|c|c|}
%\hline 
%\textbf{Names}              & \textbf{Keyword}                  & \textbf{Localisation}     & \textbf{Probes}   & \textbf{Fields}   \\ \hline
%\hline
%                            &                                   & P0: element gravity center    & \textbf{grav} & \textbf{elem}     \\
%Pressure                    & \textbf{pressure}                 & P1: vertices              & \textbf{som}      & \textbf{som}      \\
%                            &                                   & Pa: faces center (for 3D) & \textbf{nodes}    & \textbf{faces}    \\ \hline
%Velocity                    & \textbf{velocity}                 & faces center              & \textbf{nodes}    & \textbf{faces}    \\ \hline
%Temperature                 & \textbf{temperature}              & faces center              & \textbf{nodes}    & \textbf{faces}    \\ \hline
%\hline
%Density $\rho$              & \textbf{masse\_volumique}         & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%Cinematic viscosity $\nu$   & \textbf{viscosite\_cinematique}   & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%Dynamic viscosity $\mu$     & \textbf{viscosite\_dynamique}     & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%\hline
%K                           & \textbf{k}                        & faces center              & \textbf{nodes}    & \textbf{faces}    \\ \hline
%eps                         & \textbf{eps}                      & faces center              & \textbf{nodes}    & \textbf{faces}    \\ \hline
%$y^+$                       & \textbf{y\_plus}                  & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%$u^*$                       & \textbf{u\_star}                  & faces center              & \textbf{nodes}    & \textbf{faces}    \\ \hline
%Turbulent viscosity         & \textbf{viscosite\_turbulente}    & element gravity center    & \textbf{grav}     & \textbf{elem}     \\ \hline
%\end{longtable}


\textbf{Be careful}, if you are in P0+P1 discretization (default option) and you post-process the pressure field at the element (or at the vertices), you will have an \textbf{interpolation} because the field is computed at the element \textbf{and} at the vertices. \\
%There is no distinction between the two fields and the code will interpolate to have pressure at the element or at the vertices.\\
%This is the same in P0+P1+Pa.




