Parameters {
	Title "Thermal coupling - Laminar flow"

	description "The case studies the thermal coupling between a fluid and a solid domains for a laminar flow."
	description "The mesh are created by Trio_U. The thermal convection scheme EF_Stab is studied."
	description "The turbulent case is studied in another validation file."
	
	Author "V. Blind, O. Cioni, U. Bieder"

	ParametersTrio_U Dimension: 3D.
	ParametersTrio_U Discretization: VEFPrep1B.
	ParametersTrio_U Thermal coupling.
	ParametersTrio_U Convection scheme (hydraulic and thermal): EF_Stab.
	
	TestCase "./TrioU/alpha_1" "laminar_coupled_pb.data" data file printed in report file
	TestCase "./TrioU/alpha_02" "laminar_coupled_pb.data"

	}	

Chapter {
	Title "Presentation"
	description " "
	
	Table {
		Title "Description"
		description "The problem is defined as one fluid domain (thermohydraulic problem) and one solid domain (conduction problem). Both problems are thermally coupled."
		description "The fluid domain is a rectangular duct, for which the velocity profile is imposed."
		description "The temperature is imposed on the upper boundary of the fluid domain. Inside the solid domain, a constant volume thermal power $q$ is imposed. A symmetry is applied on the lower boundary of the solid."
		description "The problem is a 3D problem, but the solutions are two-dimensional."
		}
	 
	 Figure {
	 	Title "Geometry"
		description "The geometry is a 3D geometry. The figure below is a schema of the geometry used for the problem."
		Width 8cm
		picture ./schema_laminar.png
	  	}
		
	Table {
	 	Title "Geometry dimensions"
		description "The table below shows the geometrical dimensions for both domains."
		description " "

		nb_columns 4
		Label "Length (m)" | "Thickness (m)" | "Heigth (m)" | "Other (m)"
		line {
			legend "Solid domain"
			file ./TrioU/alpha_1/solide_dim.dat
			}
		line {
			legend "Fluid domain"
			file ./TrioU/alpha_1/fluide_dim.dat
			}		
		}
	
	Table {
	 	Title "Fluid physical properties"
		description "Fluid incompressible, constant physical properties."
		description "The parameters are chosen in order to obtain a Prandtl number \latex_($Pr=\dfrac{\mu.Cp}{\lambda}$\latex_) equal to 1."
		
		description " "		
		nb_columns 1
		Label Value
		line {
			legend "$\rho$  ($kg/m^3$)"
			file ./TrioU/alpha_1/rho_f.dat
			}
		line {
			legend "$\mu$  ($kg/m/s$)"
			file ./TrioU/alpha_1/mu_f.dat
			}
		line {
			legend "Cp  ($J/kg/K$)"
			file ./TrioU/alpha_1/cp_f.dat
			}
		line {
			legend "$\lambda$  ($W/m/K$)"
			file ./TrioU/alpha_1/lambda_f.dat
			}
		line {
			legend "$\beta$  ($1/K$)"
			values 1
			}
		line {
			legend "$Pr$"
			file ./TrioU/alpha_1/Prandtl.dat
			}		
		
		}
		
	Table {
	 	Title "Solid physical properties"
		description "Constant physical properties."
		description " "
		
		nb_columns 1
		Label Value
		line {
			legend "$\rho$  ($kg/m^3$)"
			file ./TrioU/alpha_1/rho_s.dat
			}
		line {
			legend "Cp  ($J/kg/K$)"
			file ./TrioU/alpha_1/cp_s.dat
			}
		line {
			legend "$\lambda$  ($W/m/K$)"
			file ./TrioU/alpha_1/lambda_s.dat
			}
		}		
	 
	 Table { 
	 	Title "Hydraulic boundary conditions"
		description "Periodicity between inlet and outlet boundaries. The velocity profile is imposed as an initial condition. The Reynolds number \latex_($Re=\dfrac{U.Dh}{\nu}=\dfrac{U.(H-h)}{2.\nu}$\latex_) is equal to 100."
		description "Upper boundary: wall."
		description "Front and back boundaries: symmetries."
		description "The joint boundary of both domains is a wall."
		}
	 
	 
	 Table {
	 	Title "Fluid thermal boundary conditions"
		description "Periodicity between inlet and outlet boundaries."
		description "Upper boundary: imposed temperature \latex_($T_0=0$\latex_)."
		description "Front and back boundaries: symmetries."
		description "The joint boundary of both domains is defined as a paroi_contact."
		}
		
	Table {
		Title "Solid thermal boundary condtions"
		description "Lower boundary: symmetry."
		description "Lateral boundaries: adiabatic walls."
		description "Volume thermal power: $q=10 \: W/m^3$." 
		description "The joint boundary of both domains is defined as a paroi_contact."
		}
	
	Visu {
		Title "Trio_U fluid mesh"
		description "The mesh is performed by a tetraedriser_homogene_fin."
		description "The figure below is a view of the fluid domain mesh."
		description " "
		Width 8cm
		Mesh ./TrioU/alpha_1/laminar_coupled_pb.lata dom_fluide
		normal3d 0.5 -0.5 0.5
		up3d 0 0 1
		}
		
	Visu {
		Title "Trio_U solid mesh"
		description "The mesh is performed by a tetraedriser_homogene_fin."
		description "The figure below is a view of the solid domain mesh."
		description " "
		Width 8cm
		Mesh ./TrioU/alpha_1/laminar_coupled_pb.lata dom_solide
		normal3d 0.5 -0.5 0.5
		up3d 0 0 1
		}
		
	Table {
		Title "Time scheme"
		description "The conduction timestep inside the solid the limiting timestep." 
		description "The time scheme is an implicit scheme, with a timestep smaller than the fluid timestep. Thus, only the solid conduction equation is implicit."
		description " "
		description "Time scheme: Euler implicit."
		description "Solver: implicit."
		description "Timestep limited by the fluid timestep."
		}
			
	Table {
		Title "Numerical scheme"
		description "Thermal coupled problem. Solid: conduction problem. Fluid: thermohydraulic problem."
		description "Hydraulic convection scheme: EF_Stab ($\alpha=1$)."
		description "Thermal convection scheme: EF_Stab: $\alpha=1$ and $\alpha=0.2$."
		}
			 
	}
	
Chapter {
	Title "Analytical solutions"
	description "The problem can be fully solved for a stationnary state."
	
	Table {
		Title "Laminar velocity profile"
		description "For a laminar flow, the velocity profile is given by:"
		description "\latex_($u(z)=U_{max}.(1-\dfrac{z^2}{D_h^2}) \qquad \text{with} \qquad U_{max}=\dfrac{3.Q}{2.(H-h)} $\latex_),"
		description "where $Q$ is the flowrate. The inlet boundary condition is defined as the laminar velocity profile."
		}
		
	Table {
		Title "Temperature profiles"
		description "Inside the solid domain (0<$z$<$h$), the thermal equation is"
		description "\latex_($\dfrac{\partial^2T_s}{\partial z^2}=-\dfrac{q}{\lambda_s} \qquad \text{which gives} \qquad T_s(z)=-\dfrac{q}{2.\lambda_s}.z^2+A.z+B $\latex_),"
		description "where $q$ is the volume thermal power and \latex_($\lambda_s$\latex_) the solid conductivity."
		description " "
		description "Inside the fluid domain ($h$<$z$<$H$), the thermal equation is:"
		description "\latex_($\dfrac{\partial^2T_f}{\partial z^2}=0 \qquad \text{which gives} \qquad T_f(z)=C.z+D$\latex_)."
		description " "
		description "The boundary conditions are:"
		description " "
		description "$z=0$, symmetry condition, \latex_($ \left.\dfrac{d T_s}{dz} \right|_0 =0$\latex_),"
		description "$z=h$, temperature equality, \latex_($T_s(h)=T_f(h)$\latex_),"
		description "$z=h$, heat flux equality, \latex_($\lambda_s.\left. \dfrac{d T_s}{dz} \right|_h=\lambda_f.\left. \dfrac{d T_f}{dz} \right|_h $\latex_),"
		description "$z=H$, imposed temperature, \latex_($T_f(H)=T_0$\latex_)."
		description " "
		description "Finally, the thermal analytical solutions are:"
		description "\latex_($T_s(z)=\dfrac{q}{2.\lambda_s}.(h^2-z^2)+\dfrac{q.h}{\lambda_f}.(H-h)+T_0 \qquad \text{and} \qquad T_f(z)=\dfrac{q.h}{\lambda_f}.(H-z)+T_0 $\latex_)."
		description "The thermal flux $\varphi$ at the joint boundary and at the upper boundary of the fluid is equal to: \latex_($\varphi=q.h$\latex_)."
		description " "
		description "The contact temperature \latex_($T_{c}$\latex_) is given by \latex_($T_{c}=T_s(h)=T_f(h)=\dfrac{q.h}{\lambda_f}.(H-h)+T_0$\latex_)."
		description " "
		description "Moreover, the maximal temperature inside the solid \latex_($T_{max}$\latex_) is located at $z=0$ and its value is:
		description "\latex_($T_{max}=T_s(0)=q.h.(\dfrac{h}{2.\lambda_s}+\dfrac{H-h}{\lambda_f})+T_0$\latex_)."
		}	
	}
	
	
Chapter {
	Title "Numerical results"
	description "Two values $\alpha$ of the thermal convection scheme are tested."
	
	Figure {
		Title "Velocity profile inside the fluid domain"
		description "The velocity profile is a Poiseuille profile."
		Dimension 2
		LabelX "z (m)"
		LabelY "Velocity (m/s)"
		Include_Description_Curves 0
		Width 10cm
		Curve {
			legend "Theory"
			file ./TrioU/alpha_1/profil_velocity.dat
			columns 1 2
			Style points
			TypeLigne -1
			TypePoints 7
			PointSize 1.5
			}
		Curve {
			legend "alpha=1"
			origin "Trio_U"
			Version "1.5.7"
			Segment ./TrioU/alpha_1/laminar_coupled_pb.data SEG_VITESSE_FLUIDE
			columns 1 2
			Style linespoints
			TypeLigne 1
			TypePoints 1
			linewidth 1.5
			PointSize 1.5
			}
		Curve {
			legend "alpha=0.2"
			origin "Trio_U"
			Version "1.5.7"
			Segment ./TrioU/alpha_02/laminar_coupled_pb.data SEG_VITESSE_FLUIDE
			columns 1 2
			Style linespoints
			TypeLigne 2
			TypePoints 2
			linewidth 1.5
			PointSize 1.5
			}
		}
		

		
	Figure {
		Title "Temporal evolution of the maximal temperature"
		description "The figure below shows the temporal evolution of the maximal temperature for both calculations."
		description "When the temperatures are constants, the stationnary state is reached."
		Dimension 2
		LabelX "Time (s)"
		LabelY "Temperature"
		Include_Description_Curves 0
		Width 10cm
		Curve {
			legend "alpha=1"
			origin "Trio_U"
			Version "1.5.7"
			file ./TrioU/alpha_1/laminar_coupled_pb_TEMP_MAX.son
			columns 1 2
			Style linespoints
			TypeLigne 1
			Typepoints 1
			linewidth 1.5
			PointSize 1.5
			}
		Curve {
			legend "alpha=0.2"
			origin "Trio_U"
			Version "1.5.7"
			file ./TrioU/alpha_02/laminar_coupled_pb_TEMP_MAX.son
			columns 1 2
			Style linespoints
			TypeLigne 2
			Typepoints 2
			linewidth 1.5
			PointSize 1.5
			}
		}


	Table {
		Title "Thermal flux comparison"
		description "The theory shows that the thermal flux at the joint boundary and at the upper boundary of the fluid are equal."
		description "For the calculations, the diffusion_chaleur.out file gives the thermal flux for the boundaries."
		description "The table below compares the theoretical and the calculated flux, which shows that the thermal flux are equal." 
		
		description " "
		nb_columns 3
                Label "Theory" | "Joint boundary" | "Upper boundary" 
		line {
                        legend "TrioU $\alpha=1$"
                        file ./TrioU/alpha_1/flux.dat
                        }
		line {
                        legend "TrioU $\alpha=0.2$"
                        file ./TrioU/alpha_02/flux.dat
                        }
		}

	Figure {
		Title "Temperature profile inside the fluid domain"
		description "For the computations, the temperature profile are calculated with a probe (segment)."
		Dimension 2
		LabelX "z (m)"
		LabelY "Temperature"
		Include_Description_Curves 0
		Width 10cm
		Curve {
			legend "Theory"
			file ./TrioU/alpha_1/profil_temp_fluide.dat
			columns 1 2
			Style points
			TypeLigne -1
			TypePoints 7
			PointSize 1.5
			}		
		Curve {
			legend "alpha=1"
			origin "Trio_U"
			Version "1.5.7"
			Segment ./TrioU/alpha_1/laminar_coupled_pb.data seg_temp_fluide
			columns 1 2
			Style linespoints
			TypeLigne 1
			Typepoints 1
			linewidth 1.5
			PointSize 1.5
			}
		Curve {
			legend "alpha=0.2"
			origin "Trio_U"
			Version "1.5.7"
			Segment ./TrioU/alpha_02/laminar_coupled_pb.data seg_temp_fluide
			columns 1 2
			Style linespoints
			TypeLigne 2
			Typepoints 2
			linewidth 1.5
			PointSize 1.5
			}
		}
		
	Figure {
		Title "Temperature profile inside the solid domain"
		description "For the computations, the solid temperature profiles are calculated with a probe (segment)."
		Dimension 2
		LabelX "z (m)"
		LabelY "Temperature"
		Include_Description_Curves 0
		Width 10cm
		Curve {
			legend "Theory"
			file ./TrioU/alpha_1/profil_temp_solide.dat
			columns 1 2
			Style points
			TypeLigne -1
			TypePoints 7
			PointSize 1.5
			}
		Curve {
			legend "alpha=1"
			origin "Trio_U"
			Version "1.5.7"
			Segment ./TrioU/alpha_1/laminar_coupled_pb.data seg_temp_solide
			columns 1 2
			Style linespoints
			TypeLigne 1
			Typepoints 1
			linewidth 1.5
			PointSize 1.5
			}
		Curve {
			legend "alpha=0.2"
			origin "Trio_U"
			Version "1.5.7"
			Segment ./TrioU/alpha_02/laminar_coupled_pb.data seg_temp_solide
			columns 1 2
			Style linespoints
			TypeLigne 2
			Typepoints 2
			linewidth 1.5
			PointSize 1.5
			}
		}


	Table {
		Title "Temperature difference inside the solid"
		description "Inside the solid domain, the theory gives: \latex_($ T_{max}-T_c=\dfrac{q.h^2}{2.\lambda_s} $\latex_)."
		description "The maximal and contact temperatures are given by probes."
		description "The table below compares the differences for both calculations. The results show that the temperature differences are correctly solved."
		
		description " "
		nb_columns 3
                Label "Theory" | "Calculation" | "Difference (%)"
		line {
                        legend "TrioU $\alpha=1$"
                        file ./TrioU/alpha_1/delta.dat
                        }
		line {
                        legend "TrioU $\alpha=0.2$"
                        file ./TrioU/alpha_02/delta.dat
                        }
		}

	Table {
		Title "Contact temperature comparison"
		description "The contact temperature between fluid and solid domains can be analytically calculated."
		description "For the calculations, the contact temperatures are calculated with probes."
		description "The table below shows the contact temperatures between calculations and theory."
		
		description " "
		nb_columns 4
                Label " " | "Theory" | "Calculation" | "Difference (%)"
		line {
                        legend "TrioU $\alpha=1$"
                        file ./TrioU/alpha_1/Tcs.dat
                        }
		line {
                        legend "TrioU $\alpha=0.2$"
                        file ./TrioU/alpha_02/Tcs.dat
                        }
		}
		
	Table {
		Title "Maximal temperature comparison"
		description "The maximal temperature in the solid is given by the theory."
		description "For the calculations, the maximal temperatures are calculated with probes."
		description "The error calculated on the maximal temperature is linked to the error calculated on the contact temperature. The difference is smaller because the value of the maximal temperature is greater than the contact temperature."
		description "The results between calculations and theory are gathered in the table below."
		
		description " "
		nb_columns 4
                Label " " | "Theory" | "Calculation" | "Difference (%)"
		line {
                	legend "TrioU $\alpha=1$"
                        file ./TrioU/alpha_1/Tmax.dat
                        }
		line {
                	legend "TrioU $\alpha=0.2$ "
                        file ./TrioU/alpha_02/Tmax.dat
                        }
		}	
	}


Chapter {
	Title "Conclusions"
	description "With the standard version used, the results are not in good accordance with the analytical results."
	description "$\alpha=0.2$ for the thermal convection scheme gives better results than $\alpha=1$."
	}
	
Chapter {
	Title "Performances"
	tableau_performance { 
	}
	}
	
	
