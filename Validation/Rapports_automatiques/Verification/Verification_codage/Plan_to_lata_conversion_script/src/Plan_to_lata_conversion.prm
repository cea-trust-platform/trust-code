Parameters {
	Title "Validation of Plan_to_lata.py script"
	versiontrust 1.7.7
	Author "N. DJATI"
	description "Plan_to_lata.py script converts .plan files generated by triokeyword(TRUST) plane probes into LATA format, which allows to visualize the plane probes locations and the post-processed field at these probes using VisIt."
	description "This script converts .plan issued from:"
        description " - 2D computations into LATA files."
	description " - 3D computations into LATA in the plane (x,y). This will be helpful if we want to post-process the field provided by the probe using VisIt. Note that it is not possible to convert a .plan file with an inclined plane into lata in the plane (x,y) since no component is constant and so removing the x-, y- or z-component will make vizualization incorrect."
	description " - 3D computations into LATA where the plan is represented in the 3D-coordinate system (x,y,z). This is helpful if you want to show beautiful and representative images of your simulation or to check that the plan probe positions are the desired ones."
	description " In this validation form, we will show various examples of vizualizations. In addition, we will use the -l option for conversion which extracts only the last time of the simulation from the plane probe."

	TestCase sim3D Canal.data
	TestCase sim2D Obstacle.data
}

Chapter {
	Title "2D simulation:"
	description "In the Obstacle.data datafile, we add two probes as follows:"
	description "triokeyword(Probes)"
	description "\latex_( \hspace{1cm} \{ \latex_)"
	description "\latex_( \hspace{1cm} \latex_) P_Probe triokeyword(pression) triokeyword(periode) 0.01 triokeyword(plan) 23 11 0.01 0.005 0.91 0.005 0.01 0.21"
	description "\latex_( \hspace{1cm} \latex_) V_Probe triokeyword(vitesse) triokeyword(periode) 0.01 triokeyword(plan) 23 11 0.01 0.005 0.91 0.005 0.01 0.21"
	description "\latex_( \hspace{1cm} \} \latex_)"
	description "At the end of the execution of Obstacle.data, TRUST will generate two PLAN files: Obstacle_P_PROBE.plan and Obstacle_V_PROBE.plan"
	Visu {
		Title "Visualization of the pressure probe"
		description "In order to convert Obstacle_P_PROBE.plan to Obstacle_P_PROBE.lata, we can use commands:"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py  Obstacle_P_PROBE -l"
		description "or"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Obstacle_P_PROBE.plan -l"
		description "or"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Obstacle_P_PROBE.plan  Obstacle_P_PROBE.lata -l"
		description "where -l option allows to extract only the last time step from the .plan file before conversion to LATA format."
		description "Below, we draw the mesh of the whole domain with the pressure field on the probe P_PROBE."
		mesh sim2D/Obstacle.lata dom
		pseudocolor sim2D/Obstacle_P_PROBE.lata P_PROBE PRESSION SOM
		cycles  -1
	}
	figure {
		Title "Pressure vizualization on the plane probe using the extrait_coupe tool"
		Titre_figure "Pressure on P_PROBE with extrait_coupe tool"
		include_description_curves 0
		Legend below
		dimension 3
		LabelX "X"
		LabelY "Y"
		Curve {
			 Plan ./sim2D/Obstacle P_PROBE 
		}
	}
	Visu {
		Title "Visualization of the velocity probe"
		description "velocity field on the V_PROBE written in Obstacle_V_PROBE.plan file can be converted to toto_obstacle.lata using commands:"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Obstacle_V_PROBE toto_obstacle -l"
		description "or"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Obstacle_V_PROBE.plan toto_obstacle.lata -l"
		description "Below, we draw the grid of V_PROBE plane and the velocity magnitude on the probe V_PROBE."
		mesh sim2D/toto_obstacle.lata V_PROBE
		pseudocolor sim2D/toto_obstacle.lata V_PROBE norme_VITESSE SOM
		cycles  -1
	}
}
Chapter {
	Title "3D simulation:"
	description "In the Canal.data datafile, we add plane probes as follows:"
	description "triokeyword(Probes)"
	description "\latex_( \hspace{1cm} \{ \latex_)"
	description "\latex_( \hspace{1cm} \latex_) sonde_PX1Z triokeyword(pression) triokeyword(periode) 1e-10 triokeyword(plan) 6 6   0. 1. 0.   10. 1. 0.   0. 1. 5."
	description "\latex_( \hspace{1cm} \latex_) sonde_PXY1 triokeyword(pression) triokeyword(periode) 1e-10 triokeyword(plan) 6 6   0. 0. 1.   10. 0. 1.   0. 2. 1."
	description "\latex_( \hspace{1cm} \latex_) sonde_VXY0 triokeyword(vitesse) triokeyword(periode) 1e-10 triokeyword(plan) 6 6 1.5 0. 0.  6. 0. 0.  1.5 2. 0."
	description "\latex_( \hspace{1cm} \latex_) sonde_pInclined triokeyword(pression) triokeyword(periode) 1e-10 triokeyword(plan) 6 6 0. 0. 0   0. 2. 0.  10. 0. 5."
	description "\latex_( \hspace{1cm} \latex_) sonde_PXYZ triokeyword(vitesse) triokeyword(periode) 1e-10 triokeyword(plan) 6 6   3. -1. 0.   3. 4. 0.    3. -1. 5."
	description "\latex_( \hspace{1cm} \latex_) sonde_V4YZ triokeyword(pression) triokeyword(periode) 1e-10 triokeyword(plan) 12 17 4. 0. 0.   4. 2. 0.  4. 0. 5."
	description "\latex_( \hspace{1cm} \} \latex_)"
	description "At the end of the execution of Canal.data, TRUST will generate 6 PLAN files."

	Visu {
		Title "2D visualization of the pressure on y=1 plane probe"
		description "in order to convert the plan file containing data on the plane probe y=1 into a lata file with values drawed on (x=X, y=Z) plan, we can use:"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PX1Z TwoDimRepresentation -lp"
		description "or"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PX1Z.plan TwoDimRepresentation.lata -l -p"
		description "where the option -p allows to consider the plane issued from the 3D simulation as a plane issued from a 2D simulation (by removing the constant component among x,y,z)"
		mesh sim3D/TwoDimRepresentation.lata SONDE_PX1Z
		pseudocolor sim3D/TwoDimRepresentation.lata SONDE_PX1Z PRESSION SOM
		cycles  -1
		Instruction_visit SetTimeSliderState(0) #TimeSliderGetNStates()-1
		Instruction_visit DrawPlots()
		Instruction_visit f=open("Coupe1_extrm_vn_trust","w")
		Instruction_visit Query("Min", use_actual_data=1)
		Instruction_visit f.write(str(GetQueryOutputValue()))
		Instruction_visit Query("Max", use_actual_data=1)
		Instruction_visit f.write(" "+str(GetQueryOutputValue()))
		Instruction_visit f.close()
	}
	figure {
		Titre_figure "Pressure on the plane y=1 with the extrait_coupe tool"
		include_description_curves 0
		Legend below
		dimension 3
		LabelX "X"
		LabelY "Z"
		Curve {
			 Plan ./sim3D/Canal SONDE_PX1Z 
		}
	}
	Visu {
		Title "3D visualization of the pressure on y=1 plane probe"
		description "In order to convert the plan file containing data on the plane probe y=1 into a lata file and keep the 3D representation of the plane, we can use:"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PX1Z -l"
		description "or"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PX1Z.plan Canal_SONDE_PX1Z.lata -l"
		mesh sim3D/Canal.lata dom
		pseudocolor sim3D/Canal_SONDE_PX1Z.lata SONDE_PX1Z PRESSION SOM
		normal3d 0.4543768 0.477396 0.733606
		cycles  -1
	}


	Visu {
		Title "Pressure visualization at z=1 plane"
		description "In order to convert the plan file containing data on the plane probe z=1 into a lata file and keep the 3D representation of the plane, we can use:"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PXY1 -l"
		description "or"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PXY1.plan Canal_SONDE_PXY1.lata -l"
		mesh sim3D/Canal.lata dom
		pseudocolor sim3D/Canal_SONDE_PXY1.lata SONDE_PXY1 PRESSION SOM
		normal3d -0.4543768 0.477396 -0.733606
		cycles  -1
	}
	Visu {
		Title "velocity magnitude on the SONDE_VXY0 plane "
		description "In order to convert the plan file containing data on the plane probe z=0 into a lata file and keep the 3D representation of the plane, we can use:"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_VXY0 -l"
		description "or"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_VXY0.plan Canal_SONDE_VXY0.lata -l"
		mesh sim3D/Canal.lata dom
		pseudocolor sim3D/Canal_SONDE_VXY0.lata SONDE_VXY0 norme_VITESSE SOM
		normal3d -0.4543768 0.477396 -0.733606
		cycles  -1
		Width 12cm
	}

	Visu {
		Title "pressure field on an inclined plane"
		description "In order to convert the plan file containing data on the inclined plane probe into a lata file and keep the 3D representation of the plane, we can use:"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PINCLINED -l"
		description "or"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PINCLINED.plan Canal_SONDE_PINCLINED.lata -l"
		mesh sim3D/Canal.lata dom
		mesh sim3D/Canal_SONDE_PINCLINED.lata SONDE_PINCLINED
		pseudocolor sim3D/Canal_SONDE_PINCLINED.lata SONDE_PINCLINED PRESSION SOM
		normal3d -0.4543768 0.477396 -0.733606
		cycles  -1
	}

	Visu {
		Title "Visualization of a plan that overflows domain boundaries"
		description "In order to convert the plan file containing data on the plane probe x=3 into a lata file and keep the 3D representation of the plane, we can use:"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PXYZ -l"
		description "or"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PXYZ.plan Canal_SONDE_PXYZ.lata -l"
		mesh sim3D/Canal.lata dom
		pseudocolor sim3D/Canal_SONDE_PXYZ.lata SONDE_PXYZ PRESSION SOM
		normal3d -0.4543768 0.477396 -0.733606
		cycles  -1
	}

	Visu {
		Title "velocity vectors on the x=4 plane"
		description "In order to convert the plan file containing data on the plane probe x=4 into a lata file and keep the 3D representation of the plane, we can use:"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_V4YZ -l"
		description "or"
		description "\latex_( \hspace{5mm} \latex_) python Plan_to_lata.py Canal_SONDE_PXYZ.plan Canal_SONDE_V4YZ.lata -l"
		mesh sim3D/Canal.lata dom
		#pseudocolor sim3D/toto.lata SONDE_VXY1 norme_VITESSE SOM
		vector      sim3D/Canal_SONDE_V4YZ.lata SONDE_V4YZ VITESSE SOM
		normal3d -0.4543768 0.477396 -0.733606 #normal3d -0.4543768 0.477396 -0.733606
		up3d 0.107612 0.185749 0.202993
		cycles  -1
	}
}


