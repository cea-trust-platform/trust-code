# Hydraulique 2D laminaire TAYLOR_COUETTE  #
/*  Re = rho*w*(R1*R1)/mu
  mu = rho*w*(R1*R1)/Re
  w = 1
  R1 = 0.5 m
  Re = 1
  rho = 1
  mu = rho*w*R1*R1/Reynolds = 1*1*0.5*0.5/1 = 0.25 */
# PARALLEL OK #
dimension 3
Pb_Hydraulique pb
Domaine dom
EcritureLectureSpecial 0

# BEGIN MESH #
read_MED short_family_names dom domain_mesh ../MESHES_TAYLOR_COUETTE/res_domain_mesh_80_exact.med
regroupebord dom Wall { TOP }
regroupebord dom Postpro { BOTTOM }
regroupebord dom Sortie { IN OUT DOWN UP }
# END MESH #

# BEGIN PARTITION
Partition dom
{
    Partition_tool tranche { tranches 2 2 1 }
    Larg_joint 2
    zones_name DOM
}
End
END PARTITION #

# BEGIN SCATTER
Scatter DOM.Zones dom
END SCATTER #

# DISCRETISATION EF #

EF dis

# SCHEMA EN TEMPS #

Schema_Euler_implicite sch
Lire sch
{
    tinit 0
    tmax 100.
    dt_min 5.e-8
    dt_impr 5.e-1
    dt_sauv 300.
    seuil_statio 1.e-5
    solveur implicite
    {
        seuil_convergence_implicite 1.e-10
        seuil_convergence_solveur  1e-10
        solveur Petsc IBICGSTAB { precond diag { } seuil 1e-10 }
    }
    facsec 2.5
}

Fluide_Incompressible fluid

Read fluid
{
    mu  Champ_Uniforme 1 0.25
    rho Champ_Uniforme 1 1.0
}

Associer pb dom
Associer pb sch
Associer pb fluid

Discretiser pb dis

Domaine out_chaud
extraire_surface
{
    domaine out_chaud
    probleme pb
    avec_certains_bords 1 Sortie
}
Domaine wall
extraire_surface
{
    domaine wall
    probleme pb
    avec_certains_bords 1 Wall
}
Lire pb
{
    Navier_Stokes_standard
    {
        projection_initiale 0
        methode_calcul_pression_initiale avec_sources_et_operateurs
        convection { generic centre }
        solveur_pression petsc cholesky { }
        diffusion { option { grad_u_transpose_partout 1 } }
        sources
        {
            Source_PDF
            {
                aire Champ_Fonc_MED last_time ../MESHES_TAYLOR_COUETTE/res_domain_mesh_80_exact.med domain_mesh aire elem 0.
                rotation Champ_Fonc_MED last_time ../MESHES_TAYLOR_COUETTE/res_domain_mesh_80_exact.med domain_mesh rotation elem 0.
                modele
                {
                    eta 1.E-12
                    local
                    vitesse_imposee_fonction 0. -(((x*x)+(y*y))_LE_(0.75*0.75))*0.5+(((x*x)+(y*y))_GE_(0.75*0.75))*1.0 0.
                }
                interpolation @INTERP_TYPE@
                {
                    @EST_DIRICHLET@ est_dirichlet Champ_Fonc_MED last_time ../MESHES_TAYLOR_COUETTE/res_domain_mesh_80_exact.med domain_mesh is_node_dirichlet som 0. @EST_DIRICHLET@
                    @POINTS_FLUIDES@ points_fluides Champ_Fonc_MED last_time ../MESHES_TAYLOR_COUETTE/res_domain_mesh_80_exact.med domain_mesh projection_Fluid som 0. @POINTS_FLUIDES@
                    @POINTS_SOLIDES@ points_solides Champ_Fonc_MED last_time ../MESHES_TAYLOR_COUETTE/res_domain_mesh_80_exact.med domain_mesh projection_Solid som 0. @POINTS_SOLIDES@
                    @ELEMENTS_FLUIDES@ elements_fluides Champ_Fonc_MED last_time ../MESHES_TAYLOR_COUETTE/res_domain_mesh_80_exact.med domain_mesh fl_elem_number som 0. @ELEMENTS_FLUIDES@
                    @ELEMENTS_SOLIDES@ elements_solides Champ_Fonc_MED last_time ../MESHES_TAYLOR_COUETTE/res_domain_mesh_80_exact.med domain_mesh so_elem_number som 0. @ELEMENTS_SOLIDES@
                    correspondance_elements Champ_Fonc_MED last_time ../MESHES_TAYLOR_COUETTE/res_domain_mesh_80_exact.med domain_mesh TRUST_SALOME_correspondance elem 0.
                }
            }
        }
        conditions_initiales
        {
            vitesse champ_uniforme 3 0. 0. 0.
        }
        conditions_limites
        {
            Wall Symetrie
            Postpro Symetrie
            Sortie frontiere_ouverte_pression_imposee Champ_front_Uniforme 1 1
        }
    }
    Post_processing
    {
        format lata
        Champs dt_post 300
        {
            pression elem
            vitesse som
        }
    }
}
resoudre pb
fin
