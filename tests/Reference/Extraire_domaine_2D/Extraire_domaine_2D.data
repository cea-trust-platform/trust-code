# Cas test Lire_Tgrid2D #

#  PARALLEL OK #


  
dimension 2
domaine dom

Pb_Thermohydraulique_Turbulent pb

# BEGIN MESH #

Read_file dom geo_2d.geom

VerifierCoin dom { }

dilate dom 0.1
 
# END MESH #

# BEGIN PARTITION
Partition dom
  {

    Partitionneur metis   { nb_parts 2   }
    Larg_joint 2
    Nom_Zones DOM
  }
End
END PARTITION #
# BEGIN SCATTER
Scatter DOM.Zones dom
END SCATTER #

VEFPreP1B dis

Read dis { P1 }

Scheme_euler_explicit sch
Read sch
{
	tinit 0.000
	tmax 20.
	dt_min 1.e-5
	dt_max 1.
	dt_impr 1.e-6
	dt_sauv 100
	seuil_statio -1
	nb_pas_dt_max 3
}

Fluide_Incompressible eau
Read eau
{
   mu      Champ_Uniforme 1 0.000134
   lambda  Champ_Uniforme 1 0.668
   Cp      Champ_Uniforme 1 4479.
   rho     Champ_Uniforme 1 866.
   beta_th Champ_Uniforme 1 0.001279
}


Champ_Uniforme gravite
Read gravite 2 0. -9.81 
Associate eau gravite

Associate pb dom
Associate pb sch
Associate pb eau

Discretize pb dis
Postraiter_domaine { domaine dom format lata }
domaine bas
extraire_domaine { domaine bas probleme pb condition_elements  (y<(-1)) }
Postraiter_domaine { domaine bas format lata fichier bas }
domaine surface 
extraire_surface 
  { 
    domaine surface
    probleme pb
    condition_elements (y<(-1))
    condition_faces (x<1e-6)
   avec_les_bords
  }
postraiter_domaine { domaine surface format lata_v2 fichier surface }
Read pb
{
     Navier_Stokes_turbulent
	{
	        solveur_pression Gcp { precond ssor { omega 1.5 } seuil 1.e-05 impr } 
		convection { ef_stab { alpha 0.5 } }
		diffusion { } 
		sources { boussinesq_temperature { T0 200. } }
		Modele_turbulence K_Epsilon {
                        Transport_K_Epsilon 
                        {
                                convection { ef_stab { alpha 1.0 } } 
                                diffusion { }
                                Sources { Source_Transport_K_Eps_anisotherme { C1_eps 1.44 C2_eps 1.92 C3_eps 1.0 } }
                                boundary_conditions {
			WALL  Paroi
			WTIN  Paroi
			WFIN  Paroi
			INH   frontiere_ouverte_K_eps_impose
			      Champ_front_uniforme 2  0.005 5.8E-5
			INV   frontiere_ouverte_K_eps_impose
			      Champ_front_uniforme 2  0.005 1.2e-4 
			OUT0  frontiere_ouverte K_EPS_EXT 
			      Champ_Front_Uniforme 2  0.005 5.8E-5
			OUTG  frontiere_ouverte K_EPS_EXT 
			      Champ_Front_Uniforme 2  0.005 5.8E-5 
                                }
                                conditions_initiales {
                                        k_Eps Champ_Uniforme 2  0.005 5.8E-5
                                }
                         }
                         Prandtl_K 0.9 # Pour tester != 1 #
			 Prandtl_Eps 1.2 # Pour tester != 1.3 #
			 CMU 0.09
			 nut_max 0.6
                         turbulence_paroi loi_standard_hydr dt_impr_ustar 100. eps_min 1.e-10
                } 
  
		conditions_initiales
		        {
			vitesse Champ_Uniforme 2 0. 0.
			}
		boundary_conditions
		{
			WALL  paroi_fixe
			WTIN  paroi_fixe
			WFIN  paroi_fixe
			INH   frontiere_ouverte_vitesse_imposee
			      Champ_front_uniforme 2  1.  0.  
			INV   frontiere_ouverte_vitesse_imposee
			      Champ_front_uniforme 2  0  -1.
			OUT0  frontiere_ouverte_pression_imposee
			      Champ_front_Uniforme 1 0.      
			OUTG  frontiere_ouverte_pression_imposee
			      Champ_front_Uniforme 1 0.

		}

        }
	Convection_Diffusion_Temperature_Turbulent
	{
		diffusion { }
		convection { ef_stab { alpha 1.0 } }
		conditions_initiales
		        {
			temperature Champ_Uniforme 1 200.
			}
		boundary_conditions
		{
		 	WALL paroi_adiabatique
			WFIN Paroi_flux_impose
				Champ_front_Uniforme 1 9.e+05
			WTIN Paroi_temperature_imposee
				Champ_front_Uniforme 1 216.667
			INH  frontiere_ouverte_temperature_imposee
			        Champ_front_Uniforme 1 250.
                        INV  frontiere_ouverte_temperature_imposee
			        Champ_front_Uniforme 1 150.
			OUT0 frontiere_ouverte T_ext
			      Champ_front_Uniforme 1 200.
			OUTG frontiere_ouverte T_ext
			      Champ_front_Uniforme 1 200.       

		}
		Modele_turbulence Prandtl
		 	{
		 	   Turbulence_paroi loi_standard_hydr_scalaire
		 	}
	}	
         Postraitement
	 {

	     Definition_champs
	     {
		vitesse_elem_bas Interpolation 
        	   { 
                     localisation elem
                     domaine bas
                     source refChamp 
                       { 
                	 pb_champ  pb vitesse
                       }
        	   }
		vitesse_bas Interpolation 
        	   { 
                     localisation elem
                     domaine bas
                     source refChamp 
                       { 
                	 pb_champ  pb vitesse
                       }
        	   }

		vitesse_min_bas Reduction_0D 
        	   { 
                     methode min
                     sources_reference { vitesse_bas } 
        	   }
		vitesse_elem_min_bas Reduction_0D 
        	   { 
                     methode min
                     sources_reference { vitesse_elem_bas } 
        	   }
	     } 
	     Sondes {
			    vitesse_elem_min_bas vitesse_elem_min_bas Periode 1e-6 numero_elem_sur_maitre 0
			    vitesse_min_bas vitesse_min_bas Periode 1e-6 numero_elem_sur_maitre 0
			    T_fimp grav temperature Periode 0.0001 Segment  89 0.01 -1.05  0.01 -9.95 
			    T_Timp grav temperature Periode 0.0001 Segment 109 0.59 +0.95  0.59 -9.95
			    T_exit grav temperature Periode 0.0001 Segment  10 0.01 -9.50  0.59 -9.50
	     }
	     domaine bas champs dt_post 0.2 { vitesse_elem_bas } 
        } 	
	postraitements
	{
	    surface	
	    {
		format lata domaine surface
		champs dt_post 0.2 { temperature elem }
	    }
	    bas 
	    { 	
		format lata
		champs dt_post 0.2 { vitesse faces } 		
	    }
	}
}
Solve pb
End
