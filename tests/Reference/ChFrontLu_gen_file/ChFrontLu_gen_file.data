# Calcul boite extrudee et test de Ecrire_fichier_xyz_valeur #
# PARALLEL OK #
dimension 3
Domaine DOM_EXTR

# BEGIN MESH #
Read_file DOM_EXTR DOM_EXTR.geom
# END MESH #

# BEGIN PARTITION
Partition DOM_EXTR
{
	Partitionneur Tranche { Tranches 1 2 1 }
	Larg_joint 2
	Nom_Zones DOM
	periodique 1 PERIO
}
End 
END PARTITION #

# BEGIN SCATTER 
Scatter DOM.Zones DOM_EXTR
END SCATTER #

Pb_Hydraulique_Turbulent pb

VEFPreP1b dis

Scheme_euler_implicit sch
Read sch 
{
	nb_pas_dt_max 10
        tinit 0.
        tmax 1000.
        seuil_statio 1.e-9
	facsec 1 
        Solveur
           Piso
           {
                seuil_convergence_solveur 1.e-6
           }
}

Fluide_Incompressible fluide
Read fluide
{
	mu Champ_Uniforme	1 1.e-3
	rho Champ_Uniforme	1 1000.
}

Associate pb DOM_EXTR
Associate pb sch
Associate pb fluide

Discretize pb dis

Read pb
{
     Navier_Stokes_Turbulent
     {
	solveur_pression GCP { precond ssor { omega 1.4 } seuil 1.e-10 impr }
        convection { muscl }
        diffusion  { }
        conditions_initiales
                {
                vitesse Champ_Uniforme 3 0.01 0. 0.
                }
        boundary_conditions
                {
		PERIO  periodique  
		paroi  paroi_fixe
                }
        sources { Canal_perio { bord PERIO } }		
		
	Modele_turbulence K_Epsilon
        {
	  Transport_K_Epsilon
	  {
	    Parametre_equation parametre_implicite { resolution_explicite }
	    convection { amont }
	    diffusion  {   }
	    boundary_conditions
	    {
	      PERIO periodique  
	      paroi paroi
	    }
	    conditions_initiales 
	    { 
	      K_Eps Champ_Uniforme 2 1.e-6 1.e-9
	    } 
	      
	  }
	  nut_max 0.01
	  turbulence_paroi loi_standard_hydr
	}
	
	Ecrire_fichier_xyz_valeur vitesse 100. bords 1 PERIO	
	Ecrire_fichier_xyz_valeur K_Eps 100. bords 1 PERIO	
	Ecrire_fichier_xyz_valeur y_plus 100. bords 1 PERIO	
    }
    Postraitement
    {       
    	   format lml
	   Champs dt_post 10.
      	   {
      		   vitesse elem 
      		   K elem  
      	   }
    }
}

Solve pb
End
