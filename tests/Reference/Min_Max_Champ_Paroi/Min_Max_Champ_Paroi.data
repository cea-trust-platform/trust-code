#  SIMULATION D UN TUYAU AVEC ECOULt TURBULENT Re=100000 et Pr=0.67 (He) + loi de paroi standard logarithmique #
dimension 3
Pb_Thermohydraulique_Turbulent pb
Domaine dom01234
Read_file dom01234 dom01234.geom
# Transformer dom01234 x y 50*z #
# PrecisionGeom 1e-6 #
Corriger_frontiere_periodique { Domaine dom01234 Bord sortie   }

VEFPreP1B dis

Scheme_euler_implicit sch
Read sch
{
	tinit 0.
	tmax 600.
	dt_min 1.e-6
	dt_max 1.e+2
	dt_impr 1000.
	dt_sauv 1000.0
	seuil_statio 1.e-8
	facsec 20
        facsec_max 200
       	Solveur
           implicite
           {
                seuil_convergence_solveur 1.e-12
           }
	nb_pas_dt_max 3
}

Fluide_Incompressible helium
Read helium
{
	mu Champ_Uniforme       1 3.93e-5
 	rho Champ_Uniforme      1 3.
        lambda Champ_Uniforme   1 0.303
        Cp Champ_Uniforme       1 5193
        beta_th Champ_Uniforme  1 1.24e-3
}

Champ_Uniforme gravite
Read gravite 3 0 0 0
 
Associate helium gravite
Associate pb dom01234
Associate pb sch
Associate pb helium

Discretize pb dis

domaine paroi_chauf
extraire_surface {
	domaine paroi_chauf
	probleme pb
	avec_certains_bords 1 paroi
	}



Read pb
{
	Navier_Stokes_Turbulent	
	{
		solveur_pression GCP { precond ssor { omega 1.6 } seuil 1.e-8 }	
		convection { EF_stab { } }
		diffusion { }
		initial_conditions {
			vitesse champ_fonc_xyz dom01234 3  0. 0. 1.31*(1-x*x-y*y)
			}
        	Sources {
			Canal_perio { bord sortie }
			}
		boundary_conditions {
			sortie  periodique  
			paroi  paroi_fixe
		}
                 Modele_turbulence K_Epsilon {
			Transport_K_Epsilon
                        {
                         convection { amont } 
                         diffusion { }
                         boundary_conditions
                            {
			     sortie  periodique 
                             paroi  paroi
                            }
                         initial_conditions
                           {
                             k_Eps Champ_Uniforme 2 4.23e-3 3.740e-3
                           }
                        }
                        Turbulence_paroi  loi_standard_hydr dt_impr_ustar 2000
                }
		Traitement_particulier { temperature { bord sortie direction 2 } }
		Ecrire_fichier_xyz_valeur vitesse 3000. bords 1 sortie
                Ecrire_fichier_xyz_valeur k_eps 3000. bords 1 sortie
        }

        Convection_Diffusion_Temperature_Turbulent
                {
                diffusion { }
		convection { EF_stab { alpha 0.2 } }

                Modele_turbulence Prandtl { Turbulence_paroi loi_standard_hydr_scalaire 
						dt_impr_nusselt 10000.
                                          }
                boundary_conditions
                        {
                        sortie periodique  
                        paroi   paroi_flux_impose Champ_Front_Uniforme 1 1000.
                        }
                initial_conditions { Temperature Champ_Fonc_xyz dom01234 1 0. }
		Ecrire_fichier_xyz_valeur temperature 3000. bords 1 sortie
                }



	Post_processings
	{
		volumique
		{
	     		Definition_champs
        		{
        		 	temperature_max Reduction_0D { methode max sources_reference { temperature_physique  } }
        		 	temperature_moy Reduction_0D { methode average sources_reference { temperature_physique  } }	
        		}
 			Probes
	       		{
			    sonde_v vitesse periode 10. point     3 -0.5 0. 1.0     0. 0. 1.0   0.5 0. 1.0	
			    sonde_t temperature periode 10. point 3 -0.5 0. 1.0     0. 0. 1.0   0.5 0. 1.0	
			    sonde_vp vitesse periode 10. segment                    30 -1.0 0. 1.0 1. 0. 1.0
			    sonde_nut viscosite_turbulente periode 10. segment      30 -1.0 0. 1.0 1. 0. 1.0
			    sonde_alphat diffusivite_turbulente periode 10. segment 30 -1.0 0. 1.0 1. 0. 1.0

			    sonde_tpn nodes temperature periode 10. segment         45 -1.0 0. 1.0 1. 0. 1.0
 			    sonde_tp  temperature periode 10. segment               45 -1.0 0. 1.0 1. 0. 1.0
 			    sonde_tparoi  temperature_physique periode 10. segment  45 -1.0 0. 1.0 1. 0. 1.0
 			    point_tparoi  temperature_physique periode 10. point 4 -1.0  0.  1.   1.0  0.  1.    0.  -1.  1.  0.   1.  1. 

			    sonde_t_phys_max temperature_max periode 10. point 1     -1. 0. 1.0 	
			    sonde_t_phys_moy temperature_moy periode 10. point 1     -1. 0. 1.0 	
            		}
              		format lata
	       		fields dt_post 150.0
	       		{
			       vitesse elem
			       temperature elem
			       temperature faces
			       temperature_physique
			       y_plus elem
			       viscosite_turbulente elem
			       diffusivite_turbulente elem
			       temperature_max
			       temperature_moy
			}
		}
		surfacique
		{
	     		Definition_champs
        		{
        		  temperature_paroi_chauf Interpolation 
        		    { 
                	      localisation elem
                	      domaine paroi_chauf
                	      sources_reference { temperature_physique } 
        		    }	
			 temperature_max_paroi_chauf Reduction_0D 
			 { 
                	      methode max
                	      sources_reference { temperature_paroi_chauf } 
        		    }	
			 temperature_moy_paroi_chauf Reduction_0D 
        		    { 
                	      methode average
                	      sources_reference { temperature_paroi_chauf } 
        		    }	
			 temperature_moy_ponderee_paroi_chauf Reduction_0D 
        		    { 
                	      methode weighted_average
                	      sources_reference { temperature_paroi_chauf } 
        		    }	
        		}
			Probes
	       		{	
			    sonde_t_phys_paroi_max 		temperature_max_paroi_chauf 		periode 10. numero_elem_sur_maitre 0
			    sonde_t_phys_paroi_moy 		temperature_moy_paroi_chauf 		periode 10. numero_elem_sur_maitre 0
			    sonde_t_phys_paroi_moy_ponderee 	temperature_moy_ponderee_paroi_chauf 	periode 10. numero_elem_sur_maitre 0
             		}
               		format lata
			domaine paroi_chauf
	       		fields dt_post 150.0
	       		{
 			       temperature_paroi_chauf
			       temperature_max_paroi_chauf
			       temperature_moy_paroi_chauf
			}	
		}
		lml
		{
			fichier Min_Max_Champ_Paroi
	       		fields dt_post 150.0
	       		{
 			       temperature
			}			
		}	
	}
	Sauvegarde binaire Conduite.sauv
}
EcritureLectureSpecial 0
Solve pb
End

