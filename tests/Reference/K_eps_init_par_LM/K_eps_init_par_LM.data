# SIMULATION D UN CANAL PLAN 2D avec modele Longueur de melange #
# PARALLEL OK #
# Tests du modele Longueur de Melange et de la procedure de calcul du frottement parietal (ParoiVEFHyd.cpp) #
dimension 2
Pb_Hydraulique_Turbulent pb
Domaine dom

# BEGIN MESH #
Mailler dom
{
Pave Cavite
        {
                Origine 0. 0.
                Nombre_de_Noeuds 4 11
                Longueurs 0.6 2.
        }
        {
                Bord periox   X = 0.  0. <= Y <= 2
                Bord periox   X = 0.6 0. <= Y <= 2
                Bord bas      Y = 0.  0. <= X <= 0.6
                Bord haut     Y = 2   0. <= X <= 0.6
 
                }
} 
Trianguler_fin dom



# END MESH #
# BEGIN PARTITION
Partition dom
{
        Partitionneur tranche { tranches 1 2 }
        Larg_joint 2
        Nom_Zones DOM
	Periodique 1 periox
}
End
END PARTITION #

# BEGIN SCATTER
Scatter DOM.Zones dom
END SCATTER #


VEFPreP1b dis

Scheme_euler_explicit sch
Read sch 
{
        tinit 0.
        tmax 20.
        dt_min 1.e-9
        dt_max 1.e-1
	dt_start dt_calc
	nb_pas_dt_max 20
        dt_impr 1e-5
        seuil_statio 1.e-8  
        facsec 1
}



Fluide_Incompressible fluide
Read fluide
{
	mu Champ_Uniforme 1 0.00001
	rho Champ_Uniforme 1 1
}

Associate pb dom
Associate pb sch
Associate pb fluide

Discretize pb dis

Read pb
	{
	Navier_Stokes_Turbulent
		{
                solveur_pression GCP {
                        precond ssor { omega 1.5 }
                        seuil 1.e-8
                }
                convection { EF_stab { } }
                diffusion  {  }
                Sources { Canal_perio { bord periox } }
		conditions_initiales
			{
                        vitesse Champ_fonc_reprise LM_pb.xyz pb vitesse last_time
			}
		boundary_conditions
			{
			periox periodique 
			haut     paroi_fixe
			bas      paroi_fixe
			}
		Modele_turbulence K_epsilon
		{
			Transport_K_Epsilon
                        {
                                convection { amont }
                                diffusion {  }
                                boundary_conditions {
        				periox periodique 
					haut     paroi
					bas      paroi
                         }
                         conditions_initiales {
			    k_Eps Champ_fonc_med last_time init_K_eps.med dom K_eps_from_nut elem 0
                                }
			}
			turbulence_paroi loi_standard_hydr
                        dt_impr_ustar 1.
		}
	}

	Postraitements
        {       
        	lml {           
			fichier K_eps_init_par_LM
			format lml Champs dt_post 100
			{
			vitesse elem
			K elem
			Eps elem
			viscosite_turbulente elem
			pression elem
			}
		}
		lata {          
			format lata Champs dt_post 100
			{
			K faces
			Eps faces
			vitesse elem
			viscosite_turbulente elem
			}
		}		
	}
}
Solve pb
End
